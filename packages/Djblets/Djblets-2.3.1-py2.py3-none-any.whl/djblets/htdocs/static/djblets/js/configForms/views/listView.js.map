{"version":3,"file":"listView.js","names":["Djblets","Config","ListView","Backbone","View","extend","tagName","className","defaultItemView","ListItemView","initialize","options","collection","model","ItemView","views","animateItems","once","listenTo","_addItem","_removeItem","_renderItems","getBody","$el","render","$listBody","trigger","item","animateItem","animate","view","fadeIn","append","push","_","find","without","fadeOut","remove","forEach","empty","each"],"sources":["listView.es6.js"],"sourcesContent":["/**\n * Display a list of items.\n *\n * This will render each item in a list, and update that list when the\n * items in the collection changes.\n *\n * It can also filter the displayed list of items.\n *\n * If loading the list through the API, this will display a loading indicator\n * until the items have been loaded.\n *\n * If 'options.animateItems' is true, then newly added or removed items will\n * be faded in/out.\n */\nDjblets.Config.ListView = Backbone.View.extend({\n    tagName: 'ul',\n    className: 'djblets-c-config-forms-list',\n    defaultItemView: Djblets.Config.ListItemView,\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object, optional):\n     *         The view options.\n     *\n     * Option Args:\n     *     ItemView (object):\n     *         The item view class to use. This argument defaults to\n     *         :js:attr:`defaultItemView`.\n     *\n     *     animateItems (boolean):\n     *         Whether or not items should be animated. This argument\n     *         defaults to ``false``.\n     */\n    initialize(options={}) {\n        const collection = this.model.collection;\n\n        this.ItemView = options.ItemView || this.defaultItemView;\n        this.views = [];\n        this.animateItems = !!options.animateItems;\n\n        this.once('rendered', () => {\n            this.listenTo(collection, 'add', this._addItem);\n            this.listenTo(collection, 'remove', this._removeItem);\n            this.listenTo(collection, 'reset', this._renderItems);\n        });\n    },\n\n    /**\n     * Return the body element.\n     *\n     * This can be overridden by subclasses if the list items should be\n     * rendered to a child element of this view.\n     *\n     * Returns:\n     *     jQuery:\n     *     Where the list view should be rendered.\n     */\n    getBody() {\n        return this.$el;\n    },\n\n    /**\n     * Render the list of items.\n     *\n     * This will loop through all items and render each one.\n     *\n     * Returns:\n     *     Djblets.Config.ListView:\n     *     This view.\n     */\n    render() {\n        this.$listBody = this.getBody();\n\n        this._renderItems();\n        this.trigger('rendered');\n\n        return this;\n    },\n\n    /**\n     * Create a view for an item and adds it.\n     *\n     * Args:\n     *     item (Backbone.Model):\n     *         The model to add.\n     *\n     *     collection (Backbone.Collection):\n     *         Ignored.\n     *\n     *     options (object, optional):\n     *         Options for adding the item.\n     *\n     * Option Args:\n     *     animate (boolean):\n     *         Whether or not to animate adding the item. This argument defaults\n     *         to ``true``.\n     */\n    _addItem(item, collection, options={}) {\n        const animateItem = (options.animate !== false);\n        const view = new this.ItemView({\n            model: item\n        });\n\n        view.render();\n\n        /*\n         * If this ListView has animation enabled, and this specific\n         * item is being animated (the default unless options.animate\n         * is false), we'll fade in the item.\n         */\n        if (this.animateItems && animateItem) {\n            view.$el.fadeIn();\n        }\n\n        this.$listBody.append(view.$el);\n        this.views.push(view);\n    },\n\n    /**\n     * Handle an item being removed from the collection.\n     *\n     * Removes the element from the list.\n     *\n     * Args:\n     *     item (Backbone.Model):\n     *         The model to remove.\n     *\n     *     collection (Backbone.Collection):\n     *         Ignored.\n     *\n     *     options (object, optional):\n     *         Options for removing the element.\n     *\n     * Option Args:\n     *     animate (boolean):\n     *         Whether or not the removal should be animated. This defaults\n     *         to ``true``.\n     */\n    _removeItem(item, collection, options={}) {\n        const animateItem = (options.animate !== false);\n        const view = _.find(this.views, view => view.model === item);\n\n        if (view) {\n            this.views = _.without(this.views, view);\n\n            /*\n             * If this ListView has animation enabled, and this specific\n             * item is being animated (the default unless options.animate\n             * is false), we'll fade out the item.\n             */\n            if (this.animateItems && animateItem) {\n                view.$el.fadeOut(function() {\n                    view.remove();\n                });\n            } else {\n                view.remove();\n            }\n        }\n    },\n\n    /**\n     * Render all items from the list.\n     */\n    _renderItems() {\n        this.views.forEach(function(view) {\n            view.remove();\n        });\n        this.views = [];\n        this.$listBody.empty();\n\n        this.model.collection.each(item => {\n            this._addItem(item, item.collection, {\n                animate: false\n            });\n        });\n    },\n});\n"],"mappings":"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"}