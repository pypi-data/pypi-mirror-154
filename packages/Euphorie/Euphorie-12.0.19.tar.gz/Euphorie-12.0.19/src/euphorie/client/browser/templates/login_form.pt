<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      xmlns:meta="http://xml.zope.org/namespaces/meta"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      id="login"
      meta:interpolation="true"
      metal:use-macro="context/@@modal-template/macros/shell"
      tal:define="
        webhelpers nocall:context/@@webhelpers;
        client nocall:request/client;
      "
      i18n:domain="euphorie"
>

  <body>
    <metal:slot fill-slot="content"
                tal:define="
                  is_guest_account webhelpers/is_guest_account;
                "
    >
      <div class="pat-modal small"
           id="document-content"
      >
        <h1 panel-class-=""
            i18n:translate="header_login"
        >Login</h1>

        <form class="wizard-box panel-class-small"
              accept-charset="UTF-8"
              action="${context/@@absolute_url}/@@login_form"
              enctype="multipart/form-data"
              method="post"
        >

          <div class="panel-body">
            <div class="container">
              <p class="message warning"
                 tal:condition="exists:view/error"
                 i18n:translate="incorrect_login"
              >
            Your login name and/or password were entered incorrectly. Please check and try again or
                <a class="reminder"
                   href="${view/reset_password_request_url}"
                   i18n:name="request_an_email_reminder"
                   i18n:translate="request_an_email_reminder"
                >reset your password</a>.
              </p>
              <input name="came_from"
                     type="hidden"
                     value="${request/came_from}"
                     tal:condition="request/came_from|nothing"
              />
              <tal:guest_account define="
                                   account webhelpers/get_current_account;
                                 "
                                 condition="is_guest_account"
              >
                <input name="guest_account_id"
                       type="hidden"
                       value="${account/id|nothing}"
                />
              </tal:guest_account>

              <fieldset class="vertical">
                <label>
                  <tal:span i18n:translate="label_email">Email address</tal:span>
                  <input class="email"
                         id="login_name"
                         autofocus="autofocus"
                         name="__ac_name"
                         tabindex="1"
                         type="email"
                         value="${request/__ac_name|nothing}"
                  />
                </label>
                <label>
                  <tal:span i18n:translate="label_login_password">Password
                    (<a class="pat-inject"
                       href="${view/reset_password_request_url}"
                       data-pat-inject="source: .wizard-box; target: .wizard-box"
                       i18n:name="forgot_link"
                       i18n:translate="label_forgot_password"
                    >I forgot my password</a>)</tal:span>
                  <input class="password"
                         id="login_password"
                         name="__ac_password:utf8:ustring"
                         tabindex="2"
                         type="password"
                  />
                </label>
                <fieldset class="pat-checklist">
                  <label>
                    <input name="remember"
                           tabindex="3"
                           type="checkbox"
                           value="True"
                    />
                    <tal:span i18n:translate="label_keep_logged_in">Keep me logged in.</tal:span>
                  </label>
                </fieldset>
                <p>
                  <tal:span i18n:translate="register_teaser">Don't have an account? Then please
                    <a href="${view/register_url}"
                       i18n:name="register_link"
                       i18n:translate="label_register_first"
                    >register</a>
                    first.</tal:span>
                </p>
              </fieldset>
            </div>
          </div>

          <div class="buttons panel-footer">
            <div class="container">
              <button class="pat-button"
                      id="login_submit"
                      name="next"
                      tabindex="4"
                      type="submit"
                      value="next"
                      i18n:translate="label_login"
              >Login</button>
              <button class="pat-button close-panel"
                      type="button"
                      i18n:translate="button_cancel"
              >Cancel</button>
            </div>
          </div>

        </form>

        <tal:block replace="tile:client-analytics" />
      </div>
    </metal:slot>
  </body>
</html>
