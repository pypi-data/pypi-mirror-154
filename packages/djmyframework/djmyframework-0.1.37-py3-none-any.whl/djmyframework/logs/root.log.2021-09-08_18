[2021-09-08T18:07:43+0800] [ERROR] [django.request] [pid:45929] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 78, in make_allow_map
    self.menu_map.setdefault(m.url_path, [])
AttributeError: 'NoneType' object has no attribute 'setdefault'
[2021-09-08T18:16:22+0800] [ERROR] [django.request] [pid:45998] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 80, in make_allow_map
    cache.set(self.cache_allow_menu_key, self.allow_menu)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 27, in _decorator
    return method(self, *args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 76, in set
    return self.client.set(*args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 126, in set
    nvalue = self.encode(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 358, in encode
    value = self._serializer.dumps(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/serializers/pickle.py", line 21, in dumps
    return pickle.dumps(value, self._pickle_version)
TypeError: 'bool' object is not callable
[2021-09-08T18:18:15+0800] [ERROR] [django.request] [pid:46304] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 81, in make_allow_map
    cache.set(self.cache_allow_menu_key, self.allow_menu)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 27, in _decorator
    return method(self, *args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 76, in set
    return self.client.set(*args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 126, in set
    nvalue = self.encode(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 358, in encode
    value = self._serializer.dumps(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/serializers/pickle.py", line 21, in dumps
    return pickle.dumps(value, self._pickle_version)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 317, in __getattr__
    return self.user_obj.get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 181, in get_resource
    _r = self._get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 186, in _get_resource
    return Resource.get_model_resource(name).get_resource_queryset(self)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 302, in get_model_resource
    return cls._resource_map[name]
KeyError: '__getstate__'
[2021-09-08T18:22:48+0800] [ERROR] [django.request] [pid:46504] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 81, in make_allow_map
    cache.set(self.cache_allow_menu_key, self.allow_menu)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 27, in _decorator
    return method(self, *args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 76, in set
    return self.client.set(*args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 126, in set
    nvalue = self.encode(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 358, in encode
    value = self._serializer.dumps(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/serializers/pickle.py", line 21, in dumps
    return pickle.dumps(value, self._pickle_version)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 317, in __getattr__
    return self.user_obj.get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 181, in get_resource
    _r = self._get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 186, in _get_resource
    return Resource.get_model_resource(name).get_resource_queryset(self)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 302, in get_model_resource
    return cls._resource_map[name]
KeyError: '__getstate__'
[2021-09-08T18:23:13+0800] [ERROR] [django.request] [pid:46523] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 81, in make_allow_map
    cache.set(self.cache_allow_menu_key, self.allow_menu)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 27, in _decorator
    return method(self, *args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 76, in set
    return self.client.set(*args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 126, in set
    nvalue = self.encode(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 358, in encode
    value = self._serializer.dumps(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/serializers/pickle.py", line 21, in dumps
    return pickle.dumps(value, self._pickle_version)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 317, in __getattr__
    return self.user_obj.get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 181, in get_resource
    _r = self._get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 186, in _get_resource
    return Resource.get_model_resource(name).get_resource_queryset(self)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 302, in get_model_resource
    return cls._resource_map[name]
KeyError: '__getstate__'
[2021-09-08T18:23:28+0800] [ERROR] [django.request] [pid:46547] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 81, in make_allow_map
    cache.set(self.cache_allow_menu_key, self.allow_menu)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 27, in _decorator
    return method(self, *args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 76, in set
    return self.client.set(*args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 126, in set
    nvalue = self.encode(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 358, in encode
    value = self._serializer.dumps(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/serializers/pickle.py", line 21, in dumps
    return pickle.dumps(value, self._pickle_version)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 317, in __getattr__
    return self.user_obj.get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 181, in get_resource
    _r = self._get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 186, in _get_resource
    return Resource.get_model_resource(name).get_resource_queryset(self)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 302, in get_model_resource
    return cls._resource_map[name]
KeyError: '__getstate__'
[2021-09-08T18:26:08+0800] [ERROR] [django.request] [pid:46640] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 82, in process_view
    the_user.make_allow_map()
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 81, in make_allow_map
    cache.set(self.cache_allow_menu_key, self.allow_menu)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 27, in _decorator
    return method(self, *args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/cache.py", line 76, in set
    return self.client.set(*args, **kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 126, in set
    nvalue = self.encode(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/client/default.py", line 358, in encode
    value = self._serializer.dumps(value)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django_redis/serializers/pickle.py", line 21, in dumps
    return pickle.dumps(value, self._pickle_version)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 317, in __getattr__
    return self.user_obj.get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 181, in get_resource
    _r = self._get_resource(name)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/user.py", line 186, in _get_resource
    return Resource.get_model_resource(name).get_resource_queryset(self)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/models/resource.py", line 302, in get_model_resource
    return cls._resource_map[name]
KeyError: '__getstate__'
[2021-09-08T18:31:23+0800] [ERROR] [django.request] [pid:46802] [/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/utils/log.py:228] Internal Server Error: /
Traceback (most recent call last):
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/exception.py", line 34, in inner
    response = get_response(request)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/.venv/lib/python3.7/site-packages/django/core/handlers/base.py", line 106, in _get_response
    response = middleware_method(request, callback, callback_args, callback_kwargs)
  File "/Users/xiezhaorong/Desktop/my_py/djmyframework/djmyframework/apps/myadmin/middleware.py", line 83, in process_view
    request.allow = request.allow_menu = the_user.allow_menu()
TypeError: 'UserAllowMenu' object is not callable
