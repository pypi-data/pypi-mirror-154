{"version":3,"sources":["pages/RunDetail/RunMetricCard.tsx","pages/RunDetail/RunDetailMetricsAndSystemTab.tsx","config/charts/index.ts","components/LineChart/LineChart.tsx","pages/RunDetail/hooks/useRunMetricsBatch.tsx"],"names":["RunMetricCard","batch","index","ErrorBoundary","className","LineChart","data","key","xValues","iters","yValues","values","color","dasharray","selectors","axesScaleType","xAxis","ScaleEnum","Linear","yAxis","ignoreOutliers","highlightMode","HighlightEnum","Off","curveInterpolation","CurveEnum","component","tint","size","weight","isSystemMetric","name","formatSystemMetricName","contextToString","context","split","map","label","i","monospace","COLORS","length","memo","RunDetailMetricsAndSystemTab","runHash","runTraces","runBatch","isSystem","isRunBatchLoading","useRunMetricsBatch","React","useEffect","analytics","ANALYTICS_EVENT_KEYS","runDetails","tabs","tabView","BusyLoaderWrapper","isLoading","height","_","isEmpty","IllustrationBlock","title","RENDER_LINES_OPTIMIZED_LIMIT","GRID_SIZE","S","M","L","CHART_GRID_PATTERN","1","2","3","4","5","6","7","8","9","forwardRef","props","ref","nameKey","aggregatedData","aggregationConfig","syncHoverState","alignmentConfig","chartTitle","zoom","onZoomChange","readOnly","resizeMode","visBoxRef","useRef","margin","top","right","bottom","left","width","plotBoxRef","parentRef","visAreaRef","svgNodeRef","bgRectNodeRef","plotNodeRef","axesNodeRef","linesNodeRef","attributesNodeRef","xAxisLabelNodeRef","yAxisLabelNodeRef","highlightedNodeRef","axesRef","brushRef","linesRef","attributesRef","humanizerConfigRef","rafIDRef","renderChart","clearArea","drawArea","processLineChartData","processedData","processedAggrData","min","max","xScale","yScale","allXValues","allYValues","current","drawAxes","drawBgTickLines","y","x","drawLines","selectChildren","classed","drawHoverAttributes","drawBrush","d3","append","text","clearHoverAttributes","draw","resizeObserverCallback","useCallback","entries","window","requestAnimationFrame","observerReturnCallback","cancelAnimationFrame","useResizeObserver","useImperativeHandle","setActiveLineAndCircle","lineKey","focusedStateActive","force","updateHoverAttributes","xValue","dataSelector","setFocusedState","focusedState","classNames","zoomMode","active","displayName","runsBatchRequestRef","runDetailAppModel","getRunMetricsBatch","metric","isNil","call","abort"],"mappings":"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","file":"static/js/RunDetailMetricsAndSystemTab.js?version=0e408e6ed19d13fd3228","sourcesContent":["import React, { memo } from 'react';\n\nimport LineChart from 'components/LineChart/LineChart';\nimport { Badge, Text } from 'components/kit';\nimport ErrorBoundary from 'components/ErrorBoundary/ErrorBoundary';\nimport { HighlightEnum } from 'components/HighlightModesPopover/HighlightModesPopover';\n\nimport COLORS from 'config/colors/colors';\n\nimport contextToString from 'utils/contextToString';\nimport { CurveEnum, ScaleEnum } from 'utils/d3';\nimport { isSystemMetric } from 'utils/isSystemMetric';\nimport { formatSystemMetricName } from 'utils/formatSystemMetricName';\n\nimport { IRunMetricCardProps } from './types';\n\nfunction RunMetricCard({\n  batch,\n  index,\n}: IRunMetricCardProps): React.FunctionComponentElement<React.ReactNode> {\n  return (\n    <ErrorBoundary>\n      <div className='RunDetailMetricsTab__container__chartContainer'>\n        <div className='RunDetailMetricsTab__container__chartContainer__chartBox'>\n          <ErrorBoundary>\n            <LineChart\n              data={[\n                {\n                  key: batch.key,\n                  data: {\n                    xValues: [...batch.iters],\n                    yValues: [...batch.values],\n                  },\n                  color: '#1c2852',\n                  dasharray: 'none',\n                  selectors: [batch.key],\n                },\n              ]}\n              index={index}\n              axesScaleType={{\n                xAxis: ScaleEnum.Linear,\n                yAxis: ScaleEnum.Linear,\n              }}\n              ignoreOutliers={false}\n              highlightMode={HighlightEnum.Off}\n              curveInterpolation={CurveEnum.Linear}\n            />\n          </ErrorBoundary>\n        </div>\n        <div className='RunDetailMetricsTab__container__chartContainer__metricDetailBox'>\n          <Text\n            component='h4'\n            tint={100}\n            size={18}\n            weight={600}\n            className='RunDetailMetricsTab__container__chartContainer__metricDetailBox__metricName'\n          >\n            {isSystemMetric(batch?.name)\n              ? formatSystemMetricName(batch?.name)\n              : batch?.name}\n          </Text>\n          {contextToString(batch?.context)\n            ?.split(',')\n            .map((label: string, i: number) => (\n              <Badge\n                key={i}\n                monospace\n                size='large'\n                color={COLORS[0][(i + index) % COLORS[0].length]}\n                label={label || 'Empty context'}\n              />\n            ))}\n        </div>\n      </div>\n    </ErrorBoundary>\n  );\n}\n\nexport default memo(RunMetricCard);\n","import React, { memo } from 'react';\nimport _ from 'lodash-es';\n\nimport IllustrationBlock from 'components/IllustrationBlock/IllustrationBlock';\nimport BusyLoaderWrapper from 'components/BusyLoaderWrapper/BusyLoaderWrapper';\nimport ErrorBoundary from 'components/ErrorBoundary/ErrorBoundary';\n\nimport { ANALYTICS_EVENT_KEYS } from 'config/analytics/analyticsKeysMap';\n\nimport * as analytics from 'services/analytics';\n\nimport { IRunBatch, IRunDetailMetricsAndSystemTabProps } from './types';\nimport RunMetricCard from './RunMetricCard';\nimport useRunMetricsBatch from './hooks/useRunMetricsBatch';\n\nfunction RunDetailMetricsAndSystemTab({\n  runHash,\n  runTraces,\n  runBatch,\n  isSystem,\n  isRunBatchLoading,\n}: IRunDetailMetricsAndSystemTabProps): React.FunctionComponentElement<React.ReactNode> {\n  useRunMetricsBatch({ runBatch, runTraces, runHash });\n\n  React.useEffect(() => {\n    analytics.pageView(\n      ANALYTICS_EVENT_KEYS.runDetails.tabs[isSystem ? 'system' : 'metrics']\n        .tabView,\n    );\n  }, [isSystem]);\n\n  return (\n    <ErrorBoundary>\n      <BusyLoaderWrapper\n        isLoading={isRunBatchLoading}\n        className='runDetailParamsTabLoader'\n        height='100%'\n      >\n        {!_.isEmpty(runBatch) ? (\n          <div className='RunDetailMetricsTab'>\n            <div className='RunDetailMetricsTab__container'>\n              {runBatch.map((batch: IRunBatch, i: number) => {\n                return (\n                  <RunMetricCard key={batch.key} batch={batch} index={i} />\n                );\n              })}\n            </div>\n          </div>\n        ) : (\n          <IllustrationBlock\n            size='xLarge'\n            className='runDetailParamsTabLoader'\n            title={`No tracked ${isSystem ? 'system' : ''} metrics`}\n          />\n        )}\n      </BusyLoaderWrapper>\n    </ErrorBoundary>\n  );\n}\n\nexport default memo(RunDetailMetricsAndSystemTab);\n","export const RENDER_LINES_OPTIMIZED_LIMIT = 100;\n\nexport const GRID_SIZE = {\n  S: 4,\n  M: 6,\n  L: 12,\n};\n\nconst { S, M, L } = GRID_SIZE;\n// Chart grid pattern based on a 12-column grid layout\nexport const CHART_GRID_PATTERN: { [key: number]: number[] } = {\n  1: [L],\n  2: [M, M],\n  3: [S, S, S],\n  4: [M, M, M, M],\n  5: [S, S, S, M, M],\n  6: [S, S, S, S, S, S],\n  7: [S, S, S, M, M, M, M],\n  8: [S, S, S, S, S, S, M, M],\n  9: [S, S, S, S, S, S, S, S, S],\n};\n","import React from 'react';\nimport * as d3 from 'd3';\nimport classNames from 'classnames';\n\nimport ErrorBoundary from 'components/ErrorBoundary/ErrorBoundary';\n\nimport { RENDER_LINES_OPTIMIZED_LIMIT } from 'config/charts';\n\nimport useResizeObserver from 'hooks/window/useResizeObserver';\n\nimport {\n  IAttributesRef,\n  IBrushRef,\n  ILineChartProps,\n} from 'types/components/LineChart/LineChart';\nimport { IFocusedState } from 'types/services/models/metrics/metricsAppModel';\n\nimport {\n  drawArea,\n  clearArea,\n  drawAxes,\n  drawLines,\n  processLineChartData,\n  drawBrush,\n  drawHoverAttributes,\n} from 'utils/d3';\n\nimport './LineChart.scss';\n\nconst LineChart = React.forwardRef(function LineChart(\n  props: ILineChartProps,\n  ref,\n): React.FunctionComponentElement<React.ReactNode> {\n  const {\n    data,\n    index = 0,\n    nameKey = '',\n    aggregatedData,\n    aggregationConfig,\n    syncHoverState,\n    axesScaleType,\n    ignoreOutliers,\n    alignmentConfig,\n    highlightMode,\n    curveInterpolation,\n    chartTitle,\n    zoom,\n    onZoomChange,\n    readOnly = false,\n    resizeMode,\n  } = props;\n\n  // boxes\n  const visBoxRef = React.useRef({\n    margin: {\n      top: 30,\n      right: 20,\n      bottom: 30,\n      left: 60,\n    },\n    height: 0,\n    width: 0,\n  });\n  const plotBoxRef = React.useRef({\n    height: 0,\n    width: 0,\n  });\n\n  // containers\n  const parentRef = React.useRef<HTMLDivElement>(null);\n  const visAreaRef = React.useRef<HTMLDivElement>(null);\n\n  // d3 node elements\n  const svgNodeRef = React.useRef(null);\n  const bgRectNodeRef = React.useRef(null);\n  const plotNodeRef = React.useRef(null);\n  const axesNodeRef = React.useRef(null);\n  const linesNodeRef = React.useRef<any>(null);\n  const attributesNodeRef = React.useRef(null);\n  const xAxisLabelNodeRef = React.useRef(null);\n  const yAxisLabelNodeRef = React.useRef(null);\n  const highlightedNodeRef = React.useRef(null);\n\n  // methods and values refs\n  const axesRef = React.useRef({});\n  const brushRef = React.useRef<IBrushRef>({});\n  const linesRef = React.useRef({});\n  const attributesRef = React.useRef<IAttributesRef>({});\n  const humanizerConfigRef = React.useRef({});\n  const rafIDRef = React.useRef<number>();\n\n  function draw() {\n    drawArea({\n      index,\n      nameKey,\n      visBoxRef,\n      plotBoxRef,\n      parentRef,\n      visAreaRef,\n      svgNodeRef,\n      bgRectNodeRef,\n      plotNodeRef,\n      axesNodeRef,\n      linesNodeRef,\n      attributesNodeRef,\n      chartTitle,\n    });\n\n    const {\n      processedData,\n      processedAggrData,\n      min,\n      max,\n      xScale,\n      yScale,\n      allXValues,\n      allYValues,\n    } = processLineChartData({\n      data,\n      ignoreOutliers,\n      visBoxRef,\n      axesScaleType,\n      aggregatedData,\n      aggregationConfig,\n    });\n\n    if (!allXValues.length || !allYValues.length) {\n      if (visAreaRef.current && !readOnly) {\n        d3.select(visAreaRef.current)\n          .append('text')\n          .classed('LineChart__emptyData', true)\n          .text('No Data');\n\n        if (attributesRef.current?.clearHoverAttributes) {\n          attributesRef.current.clearHoverAttributes();\n        }\n      }\n      return;\n    }\n\n    attributesRef.current.xScale = xScale;\n    attributesRef.current.yScale = yScale;\n\n    drawAxes({\n      svgNodeRef,\n      axesNodeRef,\n      axesRef,\n      plotBoxRef,\n      xScale: attributesRef.current.xScale,\n      yScale: attributesRef.current.yScale,\n      visBoxRef,\n      alignmentConfig,\n      axesScaleType,\n      humanizerConfigRef,\n      drawBgTickLines: { y: true, x: false },\n    });\n\n    drawLines({\n      index,\n      processedData,\n      nameKey,\n      linesNodeRef,\n      linesRef,\n      curveInterpolation,\n      xScale,\n      yScale,\n      highlightMode,\n      aggregationConfig,\n      processedAggrData,\n    });\n\n    // render lines with low quality if lines count are more than 'RENDER_LINES_OPTIMIZED_LIMIT'\n    if (!readOnly && linesNodeRef.current) {\n      const linesCount = linesNodeRef.current.selectChildren().size();\n      if (linesCount > RENDER_LINES_OPTIMIZED_LIMIT) {\n        linesNodeRef.current.classed('optimizeRendering', true);\n      }\n    }\n\n    if (!readOnly) {\n      drawHoverAttributes({\n        index,\n        nameKey,\n        data,\n        axesScaleType,\n        highlightMode,\n        syncHoverState,\n        visAreaRef,\n        attributesRef,\n        plotBoxRef,\n        visBoxRef,\n        svgNodeRef,\n        bgRectNodeRef,\n        attributesNodeRef,\n        xAxisLabelNodeRef,\n        yAxisLabelNodeRef,\n        linesNodeRef,\n        highlightedNodeRef,\n        aggregationConfig,\n        alignmentConfig,\n      });\n    }\n\n    drawBrush({\n      index,\n      brushRef,\n      plotBoxRef,\n      plotNodeRef,\n      visBoxRef,\n      axesRef,\n      attributesRef,\n      linesRef,\n      svgNodeRef,\n      axesScaleType,\n      min,\n      max,\n      zoom,\n      onZoomChange,\n      readOnly,\n    });\n  }\n\n  function renderChart() {\n    clearArea({ visAreaRef });\n    draw();\n  }\n\n  const resizeObserverCallback: ResizeObserverCallback = React.useCallback(\n    (entries: ResizeObserverEntry[]) => {\n      if (entries?.length) {\n        rafIDRef.current = window.requestAnimationFrame(renderChart);\n      }\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [\n      data,\n      zoom,\n      ignoreOutliers,\n      highlightMode,\n      axesScaleType,\n      curveInterpolation,\n      aggregationConfig,\n      readOnly,\n      alignmentConfig,\n      resizeMode,\n    ],\n  );\n\n  const observerReturnCallback = React.useCallback(() => {\n    if (rafIDRef.current) {\n      window.cancelAnimationFrame(rafIDRef.current);\n    }\n  }, []);\n\n  useResizeObserver(resizeObserverCallback, parentRef, observerReturnCallback);\n\n  React.useEffect(() => {\n    rafIDRef.current = window.requestAnimationFrame(renderChart);\n    return () => {\n      if (rafIDRef.current) {\n        window.cancelAnimationFrame(rafIDRef.current);\n      }\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [\n    data,\n    zoom,\n    ignoreOutliers,\n    highlightMode,\n    axesScaleType,\n    curveInterpolation,\n    aggregationConfig,\n    readOnly,\n    alignmentConfig,\n    resizeMode,\n  ]);\n\n  React.useImperativeHandle(ref, () => ({\n    setActiveLineAndCircle: (\n      lineKey: string,\n      focusedStateActive: boolean = false,\n      force: boolean = false,\n    ) => {\n      attributesRef.current.setActiveLineAndCircle?.(\n        lineKey,\n        focusedStateActive,\n        force,\n      );\n    },\n    updateHoverAttributes: (xValue: number, dataSelector?: string) => {\n      attributesRef.current.updateHoverAttributes?.(xValue, dataSelector);\n    },\n    clearHoverAttributes: () => {\n      attributesRef.current.clearHoverAttributes?.();\n    },\n    setFocusedState: (focusedState: IFocusedState) => {\n      attributesRef.current.focusedState = focusedState;\n    },\n  }));\n\n  return (\n    <ErrorBoundary>\n      <div\n        ref={parentRef}\n        className={classNames('LineChart', {\n          zoomMode: !readOnly && zoom?.active,\n        })}\n      >\n        <div ref={visAreaRef} />\n      </div>\n    </ErrorBoundary>\n  );\n});\n\nLineChart.displayName = 'LineChart';\n\nexport default React.memo(LineChart);\n","import React from 'react';\nimport _ from 'lodash-es';\n\nimport runDetailAppModel from 'services/models/runs/runDetailAppModel';\n\nfunction useRunMetricsBatch({ runBatch, runTraces, runHash }: any) {\n  React.useEffect(() => {\n    const runsBatchRequestRef = runDetailAppModel.getRunMetricsBatch(\n      runTraces.metric,\n      runHash,\n    );\n    if (!runBatch && !_.isNil(runTraces)) {\n      runsBatchRequestRef.call();\n    }\n    return () => {\n      runsBatchRequestRef.abort();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [runTraces, runHash]);\n}\n\nexport default useRunMetricsBatch;\n"],"sourceRoot":""}