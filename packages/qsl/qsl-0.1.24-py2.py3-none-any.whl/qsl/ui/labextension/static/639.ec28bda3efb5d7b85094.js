(self.webpackChunkqslwidgets=self.webpackChunkqslwidgets||[]).push([[639,40,772],{84458:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.defaultWidgetState=t.CommonWidget=void 0;const l=n(a(56271)),i=a(78564),o=a(4741),s=n(a(20544));t.defaultWidgetState={states:[],urls:[],type:"image",message:"",config:{image:[],regions:[]},labels:{image:{},polygons:[],masks:[],boxes:[]},action:"",preload:[],maxCanvasSize:512,maxViewHeight:512,idx:0,viewState:"labeling",sortedIdxs:[],mediaIndex:{rows:[],columns:[]},buttons:{next:!0,prev:!0,save:!0,config:!0,delete:!0,ignore:!0,unignore:!0},base:{serverRoot:"",url:""},progress:-1,mode:"light"};const r=({extract:e})=>{var t,a;const{setToast:n}=l.default.useContext(s.default),r=e("config"),d=e("states"),u=e("urls"),c=e("type"),m=e("labels"),f=e("action"),g=e("progress"),p=e("mode"),v=e("buttons"),b=e("preload"),h=e("maxCanvasSize"),y=e("maxViewHeight"),x=e("viewState"),w=e("mediaIndex"),O=e("idx"),E=e("message"),j=e("sortedIdxs");l.default.useEffect((()=>{""!==E.value&&(n(E.value),E.set(""))}),[E.value,n]);const k={config:{image:(null===(t=r.value)||void 0===t?void 0:t.image)||[],regions:(null===(a=r.value)||void 0===a?void 0:a.regions)||[]},preload:b.value,options:{progress:g.value,maxCanvasSize:h.value,showNavigation:!0,maxViewHeight:y.value},callbacks:{onSave:v.value.save?e=>{m.set(e),f.set("save")}:void 0,onSaveConfig:v.value.config?r.set:void 0,onNext:v.value.next?()=>f.set("next"):void 0,onPrev:v.value.prev?()=>f.set("prev"):void 0,onDelete:v.value.delete?()=>f.set("delete"):void 0,onIgnore:v.value.ignore?()=>f.set("ignore"):void 0,onUnignore:v.value.unignore?()=>f.set("unignore"):void 0,onShowIndex:()=>f.set("index")}};return l.default.createElement(i.ThemeProvider,{theme:i.createTheme({palette:{mode:p.value||"light"}})},l.default.createElement(i.ScopedCssBaseline,null,l.default.createElement(i.Box,{style:{padding:16}},l.default.createElement(i.Box,{hidden:"index"!==x.value},l.default.createElement(o.MediaIndex,{grid:w.value,setSortedIdxs:j.set,rowKey:"qslId",idx:O.value,visible:"index"===x.value,sortedIdxs:j.value,label:e=>{O.set(e),f.set("label")},viewHeight:y.value})),0===d.value.length||"index"===x.value?null:1==d.value.length?"image"===c.value?l.default.createElement(o.ImageLabeler,Object.assign({},k,{labels:m.value||{},target:"transitioning"===x.value?void 0:u.value[0],metadata:"transitioning"===x.value?{}:d.value[0].metadata})):"video"===c.value?l.default.createElement(o.VideoLabeler,Object.assign({},k,{labels:Array.isArray(m.value)?m.value:[],target:u.value[0],metadata:"transitioning"===x.value?{}:d.value[0].metadata})):"time-series"==c.value?l.default.createElement(o.TimeSeriesLabeler,Object.assign({},k,{labels:m.value||{},target:"transitioning"===x.value?void 0:u.value[0],metadata:"transitioning"===x.value?{}:d.value[0].metadata})):null:l.default.createElement(o.BatchImageLabeler,Object.assign({},k,{labels:m.value||{},target:u.value,states:"transitioning"===x.value?[]:d.value,setStates:e=>d.set(e)})))))};t.CommonWidget=e=>l.default.createElement(o.Labeler,null,l.default.createElement(r,Object.assign({},e)))},82639:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MediaLabelerView=t.MediaLabelerModel=void 0;const l=n(a(56271)),i=n(a(14456)),o=a(97697),s=a(82565),r=a(47295),d=a(84458),u=a(18657),c=({model:e})=>{const t=r.useModelStateExtractor(e),a=t("base");return l.default.useEffect((()=>{a.set({serverRoot:o.PageConfig.getOption("serverRoot"),url:o.PageConfig.getBaseUrl()})})),l.default.createElement(d.CommonWidget,{extract:t})};class m extends s.DOMWidgetModel{defaults(){return Object.assign(Object.assign(Object.assign({},super.defaults()),{_model_name:m.model_name,_model_module:m.model_module,_model_module_version:m.model_module_version,_view_name:m.view_name,_view_module:m.view_module,_view_module_version:m.view_module_version}),d.defaultWidgetState)}}t.MediaLabelerModel=m,m.serializers=Object.assign({},s.DOMWidgetModel.serializers),m.model_name="MediaLabelerModel",m.model_module=u.MODULE_NAME,m.model_module_version=u.MODULE_VERSION,m.view_name="MediaLabelerView",m.view_module=u.MODULE_NAME,m.view_module_version=u.MODULE_VERSION;class f extends s.DOMWidgetView{render(){this.el.classList.add("qsl-image-labeler-widget");const e=l.default.createElement(c,{model:this.model});i.default.render(e,this.el)}}t.MediaLabelerView=f},47295:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.useModelEvent=t.useModelState=t.useModelStateExtractor=void 0;const l=n(a(56271)),i=(e,t)=>{const[a,n]=l.default.useState(null==t?void 0:t.get(e));return o(t,`change:${e}`,(t=>{n(t.get(e))}),[e]),{value:a,set:function(a,n){null==t||t.set(e,a,n),null==t||t.save_changes()}}};t.useModelState=i,t.useModelStateExtractor=e=>t=>i(t,e);const o=(e,t,a,n)=>{l.default.useEffect((()=>{const n=t=>e&&a(e,t);return null==e||e.on(t,n),()=>{null==e||e.unbind(t,n)}}),(n||[]).concat([e]))};t.useModelEvent=o},72428:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=a(78564),i=a(47359),o=n(a(56271)),s=n(a(34591)),r=n(a(63742)),d=n(a(20544)),u=n(a(72762)),c=n(a(87428)),m=a(5610),f=a(30969),g=l.styled(l.ImageList)`
  & .MuiImageListItem-root {
    width: 100%;

    & img {
      transition: opacity 1s;
      z-index: 0;
      opacity: 1;
    }

    &.active,
    &:active img {
      transition: opacity 1s;
      opacity: 0.25;
    }
  }
  & .MuiImageListItemBar-titleWrap {
    padding: 8px;
  }
  & .MuiImageListItemBar-root {
    z-index: 1;
    background: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0.7) 0%,
      rgba(0, 0, 0, 0.3) 70%,
      rgba(0, 0, 0, 0) 100%
    );
  }
`;t.default=({target:e=[],labels:t,options:a,callbacks:n,setStates:p,states:v,config:b={image:[],regions:[]},columns:h=3})=>{const y=f.useMediaLarge(),x=o.default.useCallback((e=>p(v.slice(0,e).concat([Object.assign(Object.assign({},v[e]),{selected:!v[e].selected})]).concat(v.slice(e+1)))),[p,v]),{setToast:w}=o.default.useContext(d.default),{draft:O,setDraft:E,resetDraft:j}=f.useDraftLabelState(t,[e]),k=o.default.useCallback((()=>(null==n?void 0:n.onSave)?n.onSave(Object.assign({},m.draft2labels(O.labels))):void 0),[O,null==n?void 0:n.onSave]);return o.default.useEffect((()=>{v&&v.some((e=>["boxes","masks","polygons"].some((t=>e.labels&&e.labels[t||"masks"]&&e.labels[t||"masks"].length>0))))&&w("Warning: One of these items has region labels that will be overwritten upon saving.")}),[v]),o.default.createElement(r.default,{layout:y?"horizontal":"vertical",progress:null==a?void 0:a.progress,control:o.default.createElement(u.default,{cursor:{radius:0,threshold:0,coords:void 0},setCursor:e=>{},disabled:!1,direction:"column",showNavigation:null==a?void 0:a.showNavigation,config:{image:null==b?void 0:b.image,regions:void 0},draft:O,setDraft:E,callbacks:Object.assign(Object.assign({},n),{onSave:(null==n?void 0:n.onSave)?k:void 0,onReset:j,onSelectAll:v.some((e=>e.visible&&!e.selected))?()=>p(v.map((e=>Object.assign(Object.assign({},e),{selected:e.visible})))):void 0,onSelectNone:v.some((e=>e.visible&&e.selected))?()=>p(v.map((e=>Object.assign(Object.assign({},e),{selected:!1})))):void 0})}),content:o.default.createElement(l.Box,null,o.default.createElement(c.default,null),o.default.createElement(g,{cols:h,sx:{mt:0},variant:"masonry"},v.map(((t,a)=>{var n;return t.visible?o.default.createElement(l.ImageListItem,{key:a,"data-index":a,onClick:()=>x(a),tabIndex:0,className:"batch-image-list-item"},o.default.createElement(l.ImageListItemBar,{position:"top",title:o.default.createElement(l.Box,{sx:{height:25}},t.ignored?o.default.createElement(l.Box,{title:"ignored",flexDirection:"row-reverse",alignItems:"center",display:"flex"},o.default.createElement(i.VisibilityOff,null)):t.labeled?o.default.createElement(l.Box,{title:"labeled",flexDirection:"row-reverse",alignItems:"center",display:"flex"},o.default.createElement(i.TurnedIn,null)):null),actionIcon:o.default.createElement(l.IconButton,{sx:{color:"white"},"aria-label":`selected ${a}`},t.selected?o.default.createElement(i.CheckCircle,null):o.default.createElement(i.Circle,null)),actionPosition:"left"}),e[a]?o.default.createElement("img",{src:e[a]}):o.default.createElement(l.Box,{sx:{mb:5}}),t.metadata?o.default.createElement(s.default,{data:Object.fromEntries(Object.entries(t.metadata||{}).concat((null===(n=t.labels)||void 0===n?void 0:n.image)?(b.image||[]).map((e=>[e.displayName||e.name,t.labels.image[e.name]?e.multiple?t.labels.image[e.name].join(", "):t.labels.image[e.name][0]:void 0])).filter((([e,t])=>void 0!==t)):[]))}):null):null}))))})}},46951:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(30969),o=a(78564),s=a(5610);t.default=({children:e,steps:t})=>{const a=l.default.useRef(null),n=o.useTheme(),[r,d]=l.default.useState(0),[u,c]=l.default.useState({text:"",show:!1,position:{x:.5,y:.5}});return l.default.useEffect((()=>{a&&(()=>{const e=t[r],n=r+1<t.length?r+1:0;if(!a.current)return;const l=a.current.querySelector(e.target);if(!l)return console.error("Failed to find target",e.target),void d(n);const o=e.offset?{x:e.offset.x*l.clientWidth,y:e.offset.y*l.clientHeight}:void 0,s=((e,t,a)=>{const n=e.getBoundingClientRect(),l=t.getBoundingClientRect(),i=n.x+(a?a.x:n.width/2),o=n.y+(a?a.y:n.height/2);return{x:(i-l.x)/l.width,y:(o-l.y)/l.height}})(l,a.current,o);c({text:e.text,show:!0,position:s}),i.delay(1500).then((()=>c({show:!1,position:s,text:e.text}))).then((()=>i.delay(250))).then((()=>d(n)))})()}),[a,r]),l.default.createElement("div",{ref:a,style:{position:"relative"}},e,l.default.createElement(o.Box,{sx:{position:"absolute",left:s.pct2css(u.position.x),top:s.pct2css(u.position.y),width:250,bgcolor:n.palette.primary.main,color:n.palette.primary.contrastText,border:"2px solid #000",boxShadow:36,transition:"opacity 125ms",p:2,zIndex:100,opacity:u.show?1:0}},l.default.createElement(o.Typography,null,u.text)))}},30284:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(42176)),s=n(a(72762)),r=n(a(70649)),d=n(a(9035)),u=n(a(63742)),c=a(30969),m=a(5610);t.default=({target:e,labels:t={image:{}},options:a,callbacks:n,metadata:f,preload:g,config:p={image:[],regions:[]}})=>{var v,b,h;const{draft:y,setDraft:x,resetDraft:w,cursor:O,setCursor:E}=c.useDraftLabelState(t,[e]),j={viewer:l.default.useRef(null),source:l.default.useRef(null),canvas:l.default.useRef(null)},k=c.useLoader(l.default.useCallback((e=>new Promise(((e,t)=>{if(j.source.current){const t={width:j.source.current.naturalWidth,height:j.source.current.naturalHeight};e({size:t,layout:t.height>t.width?"horizontal":"vertical"})}else t("Did not find source ref.")}))),[j.source,e]),e),_=l.default.useCallback((()=>{var e;return(null==n?void 0:n.onSave)?n.onSave(Object.assign(Object.assign({},m.draft2labels(y.labels)),{dimensions:null===(e=k.mediaState)||void 0===e?void 0:e.size})):void 0}),[y,k.mediaState,null==n?void 0:n.onSave]),M=c.useMediaMouseCallbacks(y,x,O,E,j,!!(p.regions&&p.regions.length>0),null==a?void 0:a.maxCanvasSize);return l.default.createElement(u.default,{metadata:f,progress:null==a?void 0:a.progress,layout:(null===(v=k.mediaState)||void 0===v?void 0:v.layout)||"horizontal",control:l.default.createElement(s.default,{cursor:O,setCursor:E,config:p,disabled:"loading"===k.loadState,direction:"horizontal"===((null===(b=k.mediaState)||void 0===b?void 0:b.layout)||"horizontal")?"column":"row",draft:y,showNavigation:null==a?void 0:a.showNavigation,setDraft:x,callbacks:Object.assign(Object.assign({},n),{onSave:(null==n?void 0:n.onSave)?_:void 0,onReset:w})}),content:l.default.createElement(i.Box,null,l.default.createElement(i.Box,null,l.default.createElement(o.default,{size:null===(h=k.mediaState)||void 0===h?void 0:h.size,maxViewHeight:null==a?void 0:a.maxViewHeight,cursor:O.coords,media:{main:e?l.default.createElement("img",Object.assign({},M,{ref:j.source,onLoad:k.callbacks.onLoad,onError:k.callbacks.onError,draggable:!1,src:k.src,style:{cursor:p.regions&&p.regions.length>0?"none":void 0}})):null,mini:e?l.default.createElement("img",{src:k.src}):null},loadState:k.loadState,onMouseLeave:()=>E(Object.assign(Object.assign({},O),{coords:void 0}))},l.default.createElement(d.default,{cursor:O,config:p,draft:y,callbacks:M}))),"loading"!==k.loadState?l.default.createElement("canvas",{style:{display:"none"},ref:j.canvas}):null,"loading"!==k.loadState&&g?l.default.createElement(r.default,{images:g}):null)})}},8800:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=a(78564),s=l(a(69771)),r=l(a(20544)),d=l(a(50594)),u=a(30969);t.default=e=>{var{children:t}=e,a=n(e,["children"]);const l={hidden:i.default.useRef(null),container:i.default.useRef(null)},[c,m]=i.default.useState(""),[f,g]=i.default.useState(!1),p=i.default.useCallback((()=>{l.hidden.current&&l.hidden.current.focus({preventScroll:!0})}),[l.hidden]);u.useInterval((()=>{const e=!(!l.container.current||!l.container.current.contains(document.activeElement));e!==f&&g(e)}),100,!0,[l,f]);const v=()=>m("");return i.default.createElement(r.default.Provider,{value:{container:l.container,setToast:m,setFocus:p,hasFocus:f}},i.default.createElement(o.Box,{className:"react-image-labeler",ref:l.container,style:{position:"relative"}},i.default.createElement(o.Box,Object.assign({},a),t,i.default.createElement(s.default,{ref:l.hidden}),i.default.createElement(o.Snackbar,{sx:{position:"absolute",height:"100%",left:"50%"},anchorOrigin:{horizontal:"center",vertical:"top"},open:""!==c,autoHideDuration:3e3,action:i.default.createElement(i.default.Fragment,null,i.default.createElement(o.IconButton,{size:"small","aria-label":"close",color:"inherit",onClick:v},i.default.createElement(d.default,{fontSize:"small"}))),onClose:v,message:c}))))}},48847:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=a(5228),s=a(47359),r=n(a(20544)),d=a(30969),u=i.styled(o.DataGrid)`
  & .MuiDataGrid-cell:focus {
    outline: none;
  }
`;t.default=e=>{const{idx:t,grid:a,label:n,rowKey:o,visible:c,viewHeight:m,sortedIdxs:f,setSortedIdxs:g}=e,p=Math.floor(m/60),v=l.default.useRef(null),[b,h]=l.default.useState(0),[y,x]=l.default.useState([]),{setFocus:w}=l.default.useContext(r.default);l.default.useEffect((()=>{if(c)if(y.length>0){const e=y[0].field;if("mediaIndexSortState"===e)return;const t=y[0].sort;g(a.rows.slice().sort(((a,n)=>{const l=a[e],i=n[e],o="asc"===t?1:-1;return l==i?0:l>i?o:-o})).map((e=>e[o])))}else g(a.rows.map((e=>e[o])))}),[y]),l.default.useEffect((()=>{c&&x([{field:"mediaIndexSortState",sort:"asc"}])}),[c]);const O=l.default.useCallback((()=>{if(!c)return;const e=f.findIndex((e=>e===t));h(Math.floor(e/p))}),[t,y,c]);d.useKeyboardEvent((e=>{if(!v.current||!c)return;let t;switch(e.key){case"ArrowRight":t=".MuiTablePagination-actions button:nth-of-type(2)";break;case"ArrowLeft":t=".MuiTablePagination-actions button:nth-of-type(1)";break;default:return}if(!t)return;const a=v.current.querySelector(t);a&&(d.simulateClick(a),w())}),[b,v,c]),l.default.useEffect(O,[t,c]);const E=l.default.useMemo((()=>a.rows.map((e=>Object.assign(Object.assign({},e),{mediaIndexSortState:f.indexOf(e[o])})))),[f,a.rows]);return l.default.createElement(i.Box,{onClick:w},l.default.createElement(i.Box,{style:{height:m,width:"100%"},ref:v},l.default.createElement(u,{disableColumnFilter:!0,rows:E,columns:a.columns.concat({field:"mediaIndexSortState",hide:!0}),pageSize:p,rowsPerPageOptions:[p],disableSelectionOnClick:!0,onRowClick:e=>{n(e.id)},selectionModel:[t],page:b,onPageChange:h,sortModel:y,onSortModelChange:x,hideFooterSelectedRowCount:!0,getRowId:e=>e[o]})),l.default.createElement(i.ButtonGroup,{sx:{mt:2},fullWidth:!0,size:"small","aria-label":"index control menu"},l.default.createElement(i.Button,{onClick:()=>n(t),startIcon:l.default.createElement(s.ArrowBack,null)},"Back to Labeling")))}},28831:function(e,t,a){"use strict";var n=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))((function(l,i){function o(e){try{r(n.next(e))}catch(e){i(e)}}function s(e){try{r(n.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}r((n=n.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=l(a(75243)),s=l(a(42176)),r=l(a(39922)),d=l(a(72762)),u=l(a(63742)),c=a(78564),m=a(5610),f=a(30969),g=a(11599),p=l(a(83601)),v=l(a(34591)),b=l(a(20544)),h=c.styled(c.Box)`
  & .metadata table {
    border: 1px solid;
  }
  & .metadata {
    margin-top: 5px;
    box-shadow: none;
    border-radius: 0;
  }
`;t.default=({target:e,labels:t,config:a={image:[]},options:l,callbacks:y,metadata:x})=>{const w={container:i.default.useRef(null),downloadable:i.default.useRef(null)},{setToast:O}=i.default.useContext(b.default),{draft:E,setDraft:j,resetDraft:k,cursor:_,setCursor:M}=f.useDraftLabelState(t,[e]),S=f.useMediaEvent((e=>{M(Object.assign(Object.assign({},_),{coords:e}))}),w.container,[_]),C=i.default.useCallback((()=>M(Object.assign(Object.assign({},_),{coords:void 0}))),[_]),I=i.default.useCallback((()=>(null==y?void 0:y.onSave)?y.onSave(Object.assign({},m.draft2labels(E.labels))):void 0),[E,null==y?void 0:y.onSave]),P=i.default.useCallback(((e,t)=>{var n;return j(Object.assign(Object.assign({},E),{labels:Object.assign(Object.assign({},E.labels),{image:Object.assign(Object.assign({},E.labels.image),{[e]:g.processSelectionChange(t,E.labels.image[e]||[],!!a.image&&(null===(n=a.image.filter((t=>t.name===e))[0])||void 0===n?void 0:n.multiple))})})}))}),[E.labels,a,j]),D=i.default.useMemo((()=>e?e.plots.reduce(((e,t)=>{var a,n;return{width:e.width+((null===(a=t.size)||void 0===a?void 0:a.width)||512),height:e.height+((null===(n=t.size)||void 0===n?void 0:n.height)||256)}}),{width:0,height:0}):void 0),[e]),B=i.default.useCallback((()=>n(void 0,void 0,void 0,(function*(){yield p.default(w.downloadable.current,{logging:!1}).then((t=>{if(!(null==e?void 0:e.filename))return;const a=t.toDataURL("image/png",1);a?o.default.saveAs(a,e.filename.toLowerCase().endsWith(".png")?e.filename:e.filename+".png"):O("Failed to render figure.")}))}))),[e,t,w.downloadable,O]);return i.default.createElement(c.Box,null,i.default.createElement(u.default,{metadata:x,progress:null==l?void 0:l.progress,layout:"vertical",control:i.default.createElement(d.default,{cursor:_,config:{image:a.image||[]},setCursor:M,allowRegion:!1,disabled:!1,direction:"row",draft:E,showNavigation:null==l?void 0:l.showNavigation,setDraft:j,callbacks:Object.assign(Object.assign({},y),{onSave:(null==y?void 0:y.onSave)?I:void 0,onReset:k,onDownload:(null==e?void 0:e.filename)?B:void 0})}),content:i.default.createElement(s.default,{cursor:_.coords,onMouseLeave:C,media:{main:e?i.default.createElement(c.Box,{ref:w.container,onMouseMove:S},i.default.createElement(r.default,{target:e,labels:E.labels,toggle:P})):void 0,mini:e?i.default.createElement(r.default,{target:e,labels:E.labels}):void 0},size:D,loadState:"loaded",maxViewHeight:null==l?void 0:l.maxViewHeight})}),e&&D?i.default.createElement(c.Box,{style:{overflow:"scroll",height:0}},i.default.createElement(h,{ref:w.downloadable,style:{display:"inline-block",padding:20}},i.default.createElement(r.default,{target:e,labels:E.labels}),x?i.default.createElement(v.default,{data:x}):null)):void 0)}},13673:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=a(30969),s=n(a(42176)),r=n(a(63742)),d=n(a(72762)),u=n(a(61609)),c=n(a(9035)),m=n(a(20544)),f=a(47359),g=a(5610);t.default=({target:e,config:t={image:[],regions:[]},labels:a,metadata:n,options:p,callbacks:v})=>{var b,h,y,x;const w={mini:l.default.useRef(null),main:l.default.useRef(null),secondaryThumbnail:l.default.useRef(null),viewer:l.default.useRef(null),canvas:l.default.useRef(null),playpause:l.default.useRef(null),fastforward:l.default.useRef(null),mute:l.default.useRef(null)},{setFocus:O,setToast:E}=l.default.useContext(m.default),j=l.default.useMemo((()=>a||[]),[a]),{playbackState:k,setPlaybackState:_,toggleMute:M}=o.usePlaybackState(w,j),{draft:S,setDraft:C,resetDraft:I,cursor:P,setCursor:D}=o.useDraftLabelState(k.labels,[k.timestamp]);o.useKeyboardEvent((e=>{let t;switch(e.key){case"Spacebar":case" ":t=S.dirty?null:"playpause",t||E("Save or reset your labels to continue playback.");break;case"ArrowRight":t=e.altKey&&!S.dirty?"fastforward":null,!t&&e.altKey&&E("Save or reset your labels to continue playback.");break;case"m":t=e.altKey?"mute":null;default:return}t&&w[t].current&&(o.simulateClick(w[t].current).then(O),e.preventDefault(),e.stopPropagation())}),[w]);const B=o.useLoader((e=>new Promise(((e,t)=>{if(w.main.current){const t={width:w.main.current.videoWidth,height:w.main.current.videoHeight};e({duration:w.main.current.duration,layout:t.height>t.width?"horizontal":"vertical",size:t})}else t("Could not handle loading because video element was missing.")}))),e),N=o.useMediaMouseCallbacks(S,C,P,D,{source:w.main,canvas:w.canvas},!!(t.regions&&t.regions.length>0),null==p?void 0:p.maxCanvasSize),L=l.default.useMemo((()=>k.paused?N:{onClick:()=>_(0),onMouseMove:void 0}),[k.paused,_]),z=[{icon:k.paused?f.PlayArrow:f.Pause,label:k.paused?"play (spacebar)":"pause (spacebar)",className:"playpause",disabled:k.paused&&S.dirty,ref:w.playpause,callbacks:{onClick:()=>_(k.paused?1:0)}},{icon:f.FastForward,label:"forward (alt→)",className:"fastforward",ref:w.fastforward,disabled:k.paused&&S.dirty,callbacks:{onClick:()=>_(k.playbackRate+1)}},{icon:k.muted?f.VolumeMute:f.VolumeUp,label:"mute/unmute forward (alt+m)",className:"mute",ref:w.mute,disabled:!k.paused,callbacks:{onClick:M}}];return l.default.createElement(r.default,{metadata:n,layout:(null===(b=B.mediaState)||void 0===b?void 0:b.layout)||"horizontal",progress:null==p?void 0:p.progress,control:l.default.createElement(d.default,{cursor:P,setCursor:D,config:t,disabled:"loading"===B.loadState||!k.paused,direction:"horizontal"===((null===(h=B.mediaState)||void 0===h?void 0:h.layout)||"horizontal")?"column":"row",draft:S,showNavigation:null==p?void 0:p.showNavigation,setDraft:C,callbacks:Object.assign(Object.assign({},v),{onSave:()=>(null==v?void 0:v.onSave)?v.onSave(g.insertOrAppendByTimestamp({labels:g.draft2labels(S.labels),timestamp:k.timestamp,end:k.end},a||[])):void 0,onReset:I})}),content:l.default.createElement(i.Box,null,l.default.createElement(s.default,{maxViewHeight:null==p?void 0:p.maxViewHeight,size:null===(y=B.mediaState)||void 0===y?void 0:y.size,loadState:B.loadState,cursor:P.coords,onMouseLeave:()=>D(Object.assign(Object.assign({},P),{coords:void 0})),media:{main:l.default.createElement("video",Object.assign({disablePictureInPicture:!0,onLoadedMetadata:B.callbacks.onLoad,onError:B.callbacks.onError},L,{ref:w.main,src:B.src,style:{cursor:t.regions&&t.regions.length>0&&k.paused?"none":void 0}})),mini:l.default.createElement("video",{src:e,ref:w.mini})},controls:l.default.createElement(i.Stack,{direction:"row",alignItems:"center",spacing:2},l.default.createElement(i.Stack,{direction:"row",alignItems:"center",spacing:0},z.map((e=>l.default.createElement(i.IconButton,Object.assign({},e.callbacks,{disabled:e.disabled,className:e.className,ref:e.ref,key:e.label,"aria-label":e.label,title:e.label,size:"small"}),l.default.createElement(e.icon,{fontSize:"small"}))))),l.default.createElement(u.default,{marks:(a||[]).map((e=>e.timestamp)),timestamp:k.timestamp,duration:null===(x=B.mediaState)||void 0===x?void 0:x.duration,secondary:k.end,secondaryThumbnail:l.default.createElement("video",{src:e,ref:w.secondaryThumbnail,style:{maxWidth:"100%",maxHeight:"100%"}}),setSecondary:e=>_(0,void 0,e),setTimestamp:e=>S.dirty?void 0:_(0,e)}))},l.default.createElement(c.default,{config:t,cursor:P,draft:S,callbacks:N})),"loading"!==B.loadState?l.default.createElement("canvas",{style:{display:"none"},ref:w.canvas}):null)})}},10955:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=a(5610);t.default=e=>{var{box:t,color:a,candidate:l}=e,s=n(e,["box","color","candidate"]);const r=t.pt1,d=t.pt2||l;if(!d)return null;const[u,c,m,f]=[Math.min,Math.max].map((e=>["x","y"].map((t=>e.apply(Math,[r,d].map((e=>e[t]))))))).flat(),g=Math.max(m-u,o.epsilon),p=Math.max(f-c,o.epsilon);return i.default.createElement("svg",Object.assign({className:"region box",width:o.pct2css(g),height:o.pct2css(p)},s,{style:Object.assign({position:"absolute",left:o.pct2css(u),top:o.pct2css(c),height:o.pct2css(p),overflow:"visible"},s.style||{})}),i.default.createElement("text",{fill:a,className:"box-text",z:0,dominantBaseline:"hanging",onClick:s.onClick},o.labels2string(t.labels)),i.default.createElement("rect",Object.assign({},s,{x:0,y:0,fill:"none",width:"100%",strokeWidth:"calc(2px / var(--media-viewer-scale, 1))",height:"100%",stroke:a,z:1})))}},87428:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(20544));t.default=()=>{const e=l.default.useContext(o.default);return l.default.createElement(i.Box,{style:{width:"100%",height:"100%",position:"absolute",top:0},onClick:e.setFocus})}},63120:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(76369));t.default=({open:e,existing:t,allowRegion:a=!0,onSave:n,onClose:s})=>{const r={properties:[],displayName:"",name:"",level:"image",options:[],mockSelected:[]},[d,u]=l.default.useState(r);l.default.useEffect((()=>{var e,a,n;t&&u(Object.assign(Object.assign({},r),{properties:[].concat((null===(e=null==t?void 0:t.config)||void 0===e?void 0:e.freeform)?["freeform"]:[]).concat((null===(a=null==t?void 0:t.config)||void 0===a?void 0:a.multiple)?["multiple"]:[]),displayName:t.config.displayName||"",name:t.config.name||"",level:t.level||"image",options:(null===(n=null==t?void 0:t.config.options)||void 0===n?void 0:n.map((e=>e.displayName||e.name)))||[]}))}),[t]);const c=l.default.useMemo((()=>d.name&&(d.properties.indexOf("freeform")>-1||d.options.length>0)),[d]),m=l.default.useMemo((()=>d.options.length>0?d.options.map((e=>Object.assign({name:e},(null==t?void 0:t.config.options)&&t.config.options.find((t=>(t.displayName||t.name)===e))||{}))):void 0),[d,t]);return l.default.createElement(i.Modal,{open:e,"aria-describedby":"add-or-update-new-label-entry-description"},l.default.createElement(i.Box,{sx:{p:2,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",color:"text.secondary",border:"2px solid #000",boxShadow:24}},l.default.createElement(i.Typography,{id:"add-or-update-new-label-entry-description",sx:{mb:1}},t?"Edit Label Configuration":"Add New Label Configuration"),l.default.createElement(i.Box,{ml:-3,mr:-3},l.default.createElement(o.default,{setSelected:(e,[t])=>u(Object.assign(Object.assign({},d),{name:t})),selected:[d.name],disabled:!!t,config:{multiple:!1,freeform:!0,name:"Name"}}),l.default.createElement(o.default,{setSelected:(e,[t])=>u(Object.assign(Object.assign({},d),{displayName:t})),selected:[d.displayName],disabled:!!t,config:{multiple:!1,freeform:!0,name:"Display Name"}}),l.default.createElement(i.Divider,{sx:{mb:2}}),l.default.createElement(o.default,{disabled:!!t,setSelected:(e,[t])=>u(Object.assign(Object.assign({},d),{level:t||d.level})),selected:[d.level],config:{options:a?[{name:"image",displayName:"Image"},{name:"regions",displayName:"Regions"}]:[{name:"image",displayName:"Image"}],multiple:!1,freeform:!1,name:"Level"}}),l.default.createElement(o.default,{setSelected:(e,t)=>u(Object.assign(Object.assign({},d),{properties:t})),selected:d.properties,config:{options:[{name:"freeform",displayName:"Freeform"},{name:"multiple",displayName:"Multiple"}],multiple:!0,freeform:!1,name:"Type"}}),l.default.createElement(o.default,{setSelected:(e,t)=>u(Object.assign(Object.assign({},d),{options:t})),selected:d.options,config:{options:[],multiple:!0,freeform:!0,name:"Options"}})),l.default.createElement(i.ButtonGroup,{size:"small","aria-label":"label editing control menu"},l.default.createElement(i.Button,{disabled:!c,onClick:()=>{n({name:d.name,displayName:d.displayName,multiple:d.properties.indexOf("multiple")>-1,freeform:d.properties.indexOf("freeform")>-1,options:m},d.level),u(r)}},"Save"),l.default.createElement(i.Button,{onClick:()=>{s(),u(r)}},"Cancel")),c?l.default.createElement(i.Box,null,l.default.createElement(i.Divider,{sx:{mt:2,mb:2}}),l.default.createElement(i.Typography,null,"Your new label configuration will look like the following."),l.default.createElement(i.Box,{sx:{ml:-3,mr:-3,mt:1,mb:-3}},l.default.createElement(o.default,{selected:d.mockSelected,setSelected:(e,t)=>u(Object.assign(Object.assign({},d),{mockSelected:t})),config:{name:d.name,displayName:d.displayName,options:m,multiple:d.properties.indexOf("multiple")>-1,freeform:d.properties.indexOf("freeform")>-1}}))):null))}},72762:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=a(78564),s=a(47359),r=l(a(99850)),d=l(a(68347)),u=l(a(63120)),c=l(a(87428)),m=l(a(20544)),f=l(a(34591)),g=a(5610),p=a(30969);t.default=e=>{var t,{draft:a,cursor:l,disabled:v,callbacks:b,showNavigation:h,setDraft:y,setCursor:x,allowRegion:w=!0}=e,O=n(e,["draft","cursor","disabled","callbacks","showNavigation","setDraft","setCursor","allowRegion"]);const E=o.useTheme(),j=Object.fromEntries(["next","prev","save","finishRegion","clearRegion","delete","ignore","selectAll","selectNone"].map((e=>[e,i.default.useRef(null)]))),k=p.useMediaLarge(),_=i.default.useMemo((()=>{var e,t;const n=a.drawing.active?"regions":"image",l={image:g.shortcutify((null===(e=O.config)||void 0===e?void 0:e.image)||[]),regions:g.shortcutify((null===(t=O.config)||void 0===t?void 0:t.regions)||[])},i=l[n]||[];return{level:n,activeConfig:i,config:l,direction:k?O.direction:"column",allowRegionSelection:(null==l?void 0:l.regions)&&l.regions.length>0&&w,disableLabelPanel:v||void 0!==a.drawing.active&&!0===a.drawing.active.region.readonly,labels:a.drawing.active?a.drawing.active.region.labels:a.labels.image,editConfig:(null==b?void 0:b.onSaveConfig)?e=>S({configEditorOpen:!0,index:i.findIndex((t=>t.name==e))}):void 0}}),[O.config,a.labels,a.drawing.active,w,v]),[M,S]=i.default.useState({configEditorOpen:!1,index:null}),{setFocus:C,hasFocus:I,setToast:P}=i.default.useContext(m.default),D=i.default.useCallback((e=>y(Object.assign(Object.assign({},a),{dirty:!0,labels:Object.assign(Object.assign({},a.labels),{[a.drawing.mode]:a.drawing.active?g.insertOrAppend(a.labels[a.drawing.mode],a.drawing.active.region,a.drawing.active.idx,e):a.labels[a.drawing.mode]}),drawing:Object.assign(Object.assign({},a.drawing),{active:void 0})}))),[a]);p.useKeyboardEvent((e=>{let t;if((null==b?void 0:b.onKeyboardEvent)&&b.onKeyboardEvent(e),!e.altKey){switch(e.key){case"A":t=e.ctrlKey&&e.shiftKey?"selectNone":null;break;case"a":t=e.ctrlKey&&!e.shiftKey?"selectAll":null;break;case"ArrowRight":t=e.ctrlKey||e.shiftKey?null:"next",a.dirty&&(P("Please save or reset your changes before advancing to next item."),t=null);break;case"ArrowLeft":t="prev",a.dirty&&(P("Please save or reset your changes before returning to previous item."),t=null);break;case"Enter":t=e.ctrlKey||e.shiftKey?null:a.drawing.active?"finishRegion":"save";break;case"Backspace":case"Delete":t=e.ctrlKey||e.shiftKey?null:a.drawing.active?"clearRegion":"delete";break;default:return}t&&j[t].current&&(p.simulateClick(j[t].current).then(C),e.preventDefault(),e.stopPropagation())}}),[b,M,a,j,C]);const B=i.default.useCallback((e=>{y(Object.assign(Object.assign({},a),{dirty:!0,labels:a.drawing.active?a.labels:Object.assign(Object.assign({},a.labels),{image:e}),drawing:a.drawing.active?Object.assign(Object.assign({},a.drawing),{active:Object.assign(Object.assign({},a.drawing.active),{region:Object.assign(Object.assign({},a.drawing.active.region),{labels:e})})}):a.drawing}))}),[a,y]);return i.default.createElement(o.Box,null,i.default.createElement(c.default,null),i.default.createElement(d.default,{config:_.activeConfig,disabled:_.disableLabelPanel,labels:_.labels,editConfig:_.editConfig,setLabels:B}),a.drawing&&(null===(t=a.drawing.active)||void 0===t?void 0:t.region.metadata)?i.default.createElement(o.Box,{sx:{position:"relative",zIndex:1}},i.default.createElement(f.default,{data:a.drawing.active.region.metadata})):null,Object.keys((a.drawing.active?_.config.regions:_.config.image)||[]).length>0?i.default.createElement(o.Divider,{sx:{mb:3}}):null,_.allowRegionSelection?i.default.createElement(o.Box,null,i.default.createElement(o.Stack,{alignContent:"center",direction:_.direction,spacing:2},i.default.createElement(o.Box,{sx:{borderRight:"masks"===a.drawing.mode?`solid 1px ${E.palette.divider}`:void 0}},i.default.createElement(o.FormControl,null,i.default.createElement(o.FormLabel,null,"Drawing Mode"),i.default.createElement(o.RadioGroup,{row:!0,className:"drawing-mode-select",onChange:e=>y(Object.assign(Object.assign({},a),{drawing:"masks"===e.target.value?{flood:!1,mode:"masks"}:{mode:e.target.value}})),value:a.drawing.mode},[["boxes","Box"],["polygons","Polygon"],["masks","Mask"]].map((([e,t],n)=>i.default.createElement(o.FormControlLabel,{key:n,value:e,control:i.default.createElement(o.Radio,{className:"drawing-mode-option",size:"small"}),label:t,disabled:!!a.drawing.active||v})))))),"masks"===a.drawing.mode?i.default.createElement(o.Box,{style:{display:"grid",gridTemplateColumns:"row"==_.direction?"100px 200px 200px":"100px 200px",gridTemplateAreas:"row"==_.direction?'"toggle threshold size"':'"toggle threshold" "size size"',gridTemplateRows:"auto",columnGap:25}},i.default.createElement(o.FormControlLabel,{style:{gridArea:"toggle"},control:i.default.createElement(o.Checkbox,{checked:a.drawing.flood,onChange:(e,t)=>y(Object.assign(Object.assign({},a),{drawing:"masks"===a.drawing.mode?Object.assign(Object.assign({},a.drawing),{flood:t}):a.drawing}))}),label:"Flood"}),i.default.createElement(o.Box,{style:{gridArea:"threshold",display:"inline-flex"}},i.default.createElement(r.default,{name:"Flood Threshold",value:l.threshold,min:0,disabled:!a.drawing.flood,max:20,width:"100%","aria-label":"segmentation mask flood threshold",onValueChange:e=>x(Object.assign(Object.assign({},l),{threshold:e}))})),i.default.createElement(o.Box,{style:{gridArea:"size",display:"inline-flex"}},i.default.createElement(r.default,{name:"Cursor Size",value:l.radius,min:1,max:50,width:"100%","aria-label":"segmentation mask labeling radius",onValueChange:e=>x(Object.assign(Object.assign({},l),{radius:e}))}))):null),i.default.createElement(o.Divider,{sx:{mb:2,mt:2}})):null,i.default.createElement(o.Stack,{direction:_.direction,spacing:2},a.drawing.active?i.default.createElement(o.ButtonGroup,{fullWidth:!0,size:"small","aria-label":"region control menu"},i.default.createElement(o.Button,{ref:j.finishRegion,onClick:()=>D(!0),startIcon:"⏎",className:"finish-region"},a.drawing.active.region.readonly?"Deselect":"Finish"),i.default.createElement(o.Button,{startIcon:"⌫",disabled:a.drawing.active.region.readonly,onClick:()=>D(!1),ref:j.clearRegion},"Delete")):i.default.createElement(o.Stack,{direction:_.direction,spacing:2,style:{width:"100%"}},(null==b?void 0:b.onSelectAll)||(null==b?void 0:b.onSelectNone)?i.default.createElement(o.ButtonGroup,{fullWidth:!0,size:"small","aria-label":"selection control menu",className:"selection-control"},(null==b?void 0:b.onSelectAll)?i.default.createElement(o.Button,{disabled:!(null==b?void 0:b.onSelectAll)||v,onClick:null==b?void 0:b.onSelectAll,startIcon:"⌃A",ref:j.selectAll,className:"select-all"},"Select All"):null,(null==b?void 0:b.onSelectNone)?i.default.createElement(o.Button,{disabled:!(null==b?void 0:b.onSelectNone)||v,onClick:null==b?void 0:b.onSelectNone,startIcon:"⌃⇧A",ref:j.selectNone,className:"select-none"},"Select None"):null):null,i.default.createElement(o.ButtonGroup,{fullWidth:!0,size:"small","aria-label":"label control menu"},i.default.createElement(o.Button,{ref:j.save,disabled:!(null==b?void 0:b.onSave)||v,onClick:null==b?void 0:b.onSave,startIcon:"⏎",className:"save"},"Save"),(null==b?void 0:b.onIgnore)||(null==b?void 0:b.onUnignore)?i.default.createElement(o.Button,{ref:j.ignore,disabled:v,onClick:(null==b?void 0:b.onIgnore)||(null==b?void 0:b.onUnignore)},(null==b?void 0:b.onIgnore)?"Ignore":"Unignore"):null,(null==b?void 0:b.onDelete)?i.default.createElement(o.Button,{startIcon:"⌫",ref:j.delete,disabled:v,onClick:b.onDelete},"Delete"):null,(null==b?void 0:b.onReset)?i.default.createElement(o.Button,{disabled:v,onClick:b.onReset},"Reset"):null,b.onDownload?i.default.createElement(o.Button,{onClick:b.onDownload},"Download"):null),(null==b?void 0:b.onPrev)||(null==b?void 0:b.onNext)||h?i.default.createElement(o.ButtonGroup,{size:"small",fullWidth:!0,"aria-label":"navigation control menu"},i.default.createElement(o.Button,{startIcon:i.default.createElement(s.KeyboardArrowLeft,null),ref:j.prev,disabled:!(null==b?void 0:b.onPrev)||a.dirty,onClick:b.onPrev},"Previous"),i.default.createElement(o.Button,{startIcon:i.default.createElement(s.KeyboardArrowRight,null),ref:j.next,disabled:!(null==b?void 0:b.onNext)||a.dirty,onClick:b.onNext},"Next")):null,(null==b?void 0:b.onSaveConfig)||(null==b?void 0:b.onShowIndex)?i.default.createElement(o.ButtonGroup,{size:"small","aria-label":"add new configuration menu",fullWidth:!0},(null==b?void 0:b.onSaveConfig)?i.default.createElement(o.Button,{startIcon:i.default.createElement(s.Add,null),className:"add-new-label",onClick:()=>S({index:null,configEditorOpen:!0})},"Add Type"):null,(null==b?void 0:b.onShowIndex)?i.default.createElement(o.Button,{startIcon:i.default.createElement(s.List,null),className:"show-data-index",disabled:v,onClick:b.onShowIndex},"View Index"):null):null),i.default.createElement(o.Box,{title:I?"Listening for keyboard shortcuts.":"Keyboard shortcuts disabled. Click inside the widget to enable.",onClick:C,style:{zIndex:1}},i.default.createElement(s.Keyboard,{color:I?"primary":"warning",fontSize:"large"}))),b&&b.onSaveConfig&&M.configEditorOpen?i.default.createElement(u.default,{allowRegion:w,open:M.configEditorOpen,onClose:()=>S(Object.assign(Object.assign({},M),{configEditorOpen:!1})),existing:null!==M.index?{config:_.activeConfig[M.index],level:_.level}:void 0,onSave:(e,t)=>{if(null===M.index&&(_.config[t]||[]).find((t=>t.name===e.name)))throw"User attempted to add a config with the name of an existing config.";const a=_.config[t],n=null===M.index?a.length:M.index;b.onSaveConfig(Object.assign(Object.assign({},_.config),{[t]:a.slice(0,n).concat([e]).concat(a.slice(n+1))})),S({index:null,configEditorOpen:!1})}}):null)}},20544:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)).default.createContext({});t.default=l},69771:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=l.default.forwardRef(((e,t)=>l.default.createElement("div",{style:{width:0,height:0,overflow:"hidden"}},l.default.createElement("div",{ref:t,className:"react-image-labeler-input-target",tabIndex:-1}))));t.default=i},70649:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271));t.default=({images:e})=>{const[t,a]=l.default.useState(0);return l.default.useEffect((()=>a(0)),[e]),l.default.createElement("div",{style:{width:0,height:0,overflow:"hidden"}},e.map(((e,n)=>n<=t?l.default.createElement("img",{src:e,key:n,onLoad:()=>a(n+1)}):null)))}},68347:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(76369));t.default=({config:e,labels:t,setLabels:a,disabled:n,editConfig:s})=>{const r=l.default.useCallback(((e,n)=>a(Object.assign(Object.assign({},t),{[e]:n}))),[t]);return l.default.createElement(i.Box,{ml:-3,mr:-3},e.map(((e,a)=>l.default.createElement(o.default,{key:e.name,config:e,disabled:n,editConfig:s,selected:t[e.name],setSelected:r}))))}},76369:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=a(47359),s=n(a(20544)),r=a(30969),d=a(11599),u=i.styled(i.Box)`
  & label.label-panel-entry-option-label {
    margin-bottom: 0;
  }

  & legend.label-panel-entry-label {
    margin-bottom: 0;
    border-bottom: none;
  }
`;t.default=({config:e,selected:t,setSelected:a,disabled:n,editConfig:c})=>{const m=l.default.useMemo((()=>e.options||e.multiple?((e,t)=>t.concat(e?e.filter((e=>-1==(t||[]).findIndex((t=>t.name===e)))).map((e=>({name:e,shortcut:""}))):[]))(t||[],e.options||[]):void 0),[e.options,t]),f=l.default.useRef(null),{setFocus:g}=l.default.useContext(s.default),p=l.default.useMemo((()=>m?m.reduce(((e,t,a)=>t.shortcut?Object.assign(Object.assign({},e),{[t.shortcut]:a}):e),{}):{}),[m]),v=l.default.useCallback((n=>a(e.name,d.processSelectionChange(n,t,e.multiple))),[t,e,a]);r.useKeyboardEvent((e=>{if(e.ctrlKey||e.shiftKey||!p)return;const t=p[e.key];if(t>-1&&f.current){const a=f.current.querySelector(`.react-image-labeler-input-target[data-index='${t}'] input`);r.simulateClick(a),e.preventDefault(),e.stopPropagation(),g()}}),[p,f,g]);const[b,h]=l.default.useState({freeform:""});return l.default.useEffect((()=>h({freeform:m||e.multiple||!e.freeform||!t?"":t[0]||""})),[t]),l.default.createElement(u,{display:"inline"},l.default.createElement(i.FormControl,{sx:{ml:3,mr:3,mt:0,mb:3},component:"fieldset",variant:"standard",className:"label-panel-entry",disabled:!!n,name:e.name},l.default.createElement(i.FormLabel,{component:"legend",className:"label-panel-entry-label"},e.displayName||e.name," ",c?l.default.createElement(i.IconButton,{"aria-label":`edit ${e.name}`,className:"edit-label-entry",onClick:()=>c(e.name)},l.default.createElement(o.Edit,null)):null),l.default.createElement(i.FormGroup,{ref:f},(m||[]).map(((a,n)=>{const o={checked:!!(t&&t.indexOf(a.name)>-1),onChange:()=>v(a.name),name:a.name,className:"react-image-labeler-input-target"},s=`${a.displayName||a.name} ${a.shortcut?`(${a.shortcut})`:""}`;return l.default.createElement(i.FormControlLabel,{className:"label-panel-entry-option-label",key:n,control:e.multiple?l.default.createElement(i.Checkbox,Object.assign({},o,{"data-index":n})):l.default.createElement(i.Radio,Object.assign({},o,{"data-index":n,onClick:o.onChange})),color:"primary",label:s})}))),e.freeform?l.default.createElement(i.Input,{value:b.freeform,name:`${e.name}-freeform`,placeholder:e.multiple?"Add new option":void 0,onKeyPress:t=>{"Enter"===t.key&&(e.multiple||m?(v(b.freeform),h({freeform:""})):g(),t.preventDefault())},onChange:t=>{h(Object.assign(Object.assign({},b),{freeform:t.target.value})),e.multiple||m||v(t.target.value),t.preventDefault(),t.stopPropagation()}}):null))}},63742:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(87428)),s=n(a(34591)),r=n(a(95599)),d=a(30969);t.default=({layout:e="horizontal",control:t,content:a,metadata:n,progress:u})=>{const c=d.useMediaLarge();return l.default.createElement(i.Box,null,void 0!==u&&u>=0?l.default.createElement(i.Box,{sx:{mb:1}},l.default.createElement(r.default,{progress:u})):null,l.default.createElement(i.Box,{style:{display:"grid",gridTemplateColumns:(a||n)&&"horizontal"===e&&c?"315px 1fr":"1fr",gridTemplateRows:"auto",gridTemplateAreas:a||n?"horizontal"===e&&c?'"control-panel image-target"':'"image-target" "control-panel"':'"control-panel"',gridColumnGap:a||n?20:0,rowGap:a||n?20:0,position:"relative"}},l.default.createElement(i.Box,{style:{position:"relative",gridArea:"control-panel"}},l.default.createElement(o.default,null),t),l.default.createElement(i.Box,{style:{position:"relative",gridArea:"image-target"}},l.default.createElement(o.default,null),l.default.createElement(i.Stack,{rowGap:1},a,n?l.default.createElement(i.Box,{sx:{position:"relative",zIndex:1}},l.default.createElement(s.default,{data:n})):null))))}},6150:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271));t.default=e=>{var{bitmap:t,color:a}=e,l=n(e,["bitmap","color"]);const o=i.default.useRef(null);return i.default.useEffect((()=>{if(t&&o.current){const e=o.current.getContext("2d");if(!e)throw"Failed to find canvas context.";o.current.width=t.dimensions.width,o.current.height=t.dimensions.height;const n=e.createImageData(t.dimensions.width,t.dimensions.height),l="red"===a?[255,0,0,127]:"blue"===a?[0,0,255,127]:[255,255,0,127];Uint8ClampedArray.from(Array.from(t.values).map((e=>255===e?l:[0,0,0,0])).flat()).forEach(((e,t)=>n.data[t]=e)),e.putImageData(n,0,0)}}),[t,a,o]),i.default.createElement("canvas",Object.assign({},l,{className:"region mask",style:Object.assign(Object.assign({},l.style||{}),{imageRendering:"pixelated",position:"absolute",width:"100%",height:"100%",top:0}),ref:o}))}},42176:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(99850)),s=n(a(20544)),r=n(a(87428)),d=a(5610),u=a(30969),c=a(14933),m=i.styled(i.Box)`
  & .minimap .mask-cursor {
    display: none;
  }

  & .minimap .box-text {
    visibility: hidden;
  }

  & .viewport img,
  .viewport video {
    vertical-align: bottom;
  }

  & .viewport .loading-placeholder .region {
    visibility: hidden;
  }

  & img,
  & video {
    max-width: none;
    max-height: none;
    image-rendering: pixelated;
    -webkit-user-drag: none;
    -khtml-user-drag: none;
    -moz-user-drag: none;
    -o-user-drag: none;
    user-drag: none;
  }
`;t.default=({children:e,media:t,size:a,controls:n,loadState:f,onMouseLeave:g,cursor:p,maxViewHeight:v=512})=>{const{setFocus:b}=l.default.useContext(s.default),h={viewport:l.default.useRef(null),minimap:l.default.useRef(null),media:l.default.useRef(null)},[y,x]=l.default.useState({zoom:1,pos:{x:0,y:0},minimapSize:{width:96,height:96},zoomInitialized:!1}),[w,O]=l.default.useState(!1),[E,j]=l.default.useState(v);l.default.useEffect((()=>{if("loading"===f)x(Object.assign(Object.assign({},y),{pos:{x:0,y:0},zoomInitialized:!1}));else if("loaded"==f&&a&&!y.zoomInitialized&&E>0){const e=96/Math.max(a.width,a.height);x(Object.assign(Object.assign({},y),{zoomInitialized:!0,zoom:Math.min(E/a.width,v/a.height),minimapSize:{width:e*a.width,height:e*a.height}}))}}),[f,a,E]),u.useInterval((()=>{!h.viewport.current||E&&h.viewport.current.clientWidth===E||j(h.viewport.current.clientWidth)}),100,!0,[E]);const k=l.default.useMemo((()=>{if(!a)return;const e={width:y.zoom*a.width,height:y.zoom*a.height},t={width:Math.min(E,e.width),height:Math.min(v,e.height)};return{raw:a,zoomed:e,viewport:t,margin:{width:t.width/e.width/2,height:t.height/e.height/2}}}),[a,E,v,y.zoom]),_=u.useMediaEvent((e=>{if(b(),!k)throw"Failed to process minimap position.";x(Object.assign(Object.assign({},y),{pos:{x:Math.max(e.x-k.margin.width,0),y:Math.max(e.y-k.margin.height,0)}}))}),h.minimap,[b,y,k]),M=l.default.useCallback((e=>{if(k){if(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.ctrlKey){const t=e.cursor||p,a=Math.max(y.zoom-e.deltaY/200,10/Math.min(k.raw.width,k.raw.height));let n;n=t?{x:Math.max(t.x-y.zoom*(t.x-y.pos.x)/a,0),y:Math.max(t.y-y.zoom*(t.y-y.pos.y)/a,0)}:y.pos,x(Object.assign(Object.assign({},y),{zoom:a,pos:n}))}else x(Object.assign(Object.assign({},y),{pos:{x:Math.max(y.pos.x+e.deltaX/k.zoomed.width,0),y:Math.max(y.pos.y+e.deltaY/k.zoomed.height,0)}}));return b(),!1}}),[y,p,k]),S=c.useGesture({onDrag:({delta:[e,t]})=>{0===e&&0===t||(M({deltaX:-e,deltaY:-t,ctrlKey:!1}),O(!0))},onDragEnd:()=>setTimeout((()=>O(!1)),250),onPinch:e=>{if(e.memo&&e.memo>0&&k){const t=u.convertCoordinates({x:e.origin[0]+window.scrollX,y:e.origin[1]+window.scrollY},h.media.current);M({deltaX:0,deltaY:e.memo-e.da[0],ctrlKey:!0,cursor:t})}return e.last?-1:e.da[0]}},{drag:{preventDefault:!0}});return l.default.useEffect((()=>{if(h.media.current)return h.media.current.addEventListener("wheel",M,{passive:!1}),()=>{h.media.current&&h.media.current.removeEventListener("wheel",M)}}),[h.media,M]),l.default.createElement(m,{className:"media-viewer"},l.default.createElement(i.Box,{sx:{mb:2}},l.default.createElement(i.Box,{className:"viewport",style:{position:"relative",overflow:"hidden",height:Math.min(v,(null==k?void 0:k.zoomed.height)||v)},ref:h.viewport},l.default.createElement(r.default,null),"loading"==f?l.default.createElement(i.CircularProgress,{style:{position:"absolute",left:"50%",right:"50%",top:"50%",bottom:"50%"}}):null,l.default.createElement(i.Box,Object.assign({className:"media",ref:h.media},S(),{onMouseLeave:"loaded"==f?g:void 0,style:"loaded"===f?{"--media-viewer-scale":y.zoom,transform:`scale(${y.zoom}) translate(${d.pct2css(-y.pos.x)}, ${d.pct2css(-y.pos.y)})`,"--media-viewer-dragging":w?1:0,transformOrigin:"0 0",position:"absolute",touchAction:"none"}:{width:0,height:0,overflow:"hidden"}}),"loaded"===f?e:null,t.main)),n||null),l.default.createElement(i.Box,{className:"controls",style:{display:"grid",gridTemplateColumns:`${y.minimapSize.width}px 1fr`,gridTemplateRows:"auto",gridTemplateAreas:'"minimap zoom"',gridColumnGap:10}},l.default.createElement(i.Paper,{className:"minimap",style:Object.assign(Object.assign({},y.minimapSize),{position:"relative"}),onClick:_},"loaded"===f&&a?l.default.createElement("div",{style:{width:"100%",height:"100%"}},l.default.createElement("div",{style:{transform:`scale(${y.minimapSize.width/a.width})`,transformOrigin:"0 0"}},t.mini),e,k?l.default.createElement("div",{style:{outline:"2px solid red",outlineOffset:"-1px",position:"absolute",left:d.pct2css(y.pos.x),top:d.pct2css(y.pos.y),width:d.pct2css(Math.min(1-y.pos.x,k.viewport.width/k.viewport.width)),height:d.pct2css(Math.min(1-y.pos.y,k.viewport.height/k.viewport.height))}}):null,l.default.createElement("div",{ref:h.minimap,className:"hover-target",style:Object.assign(Object.assign({position:"absolute",top:0},y.minimapSize),{display:"block"})})):null),l.default.createElement(o.default,{name:"Zoom",className:"zoom",min:Math.min(1,Math.round(100*y.zoom)),max:Math.max(500,Math.round(100*y.zoom)),width:"100%",value:Math.round(100*y.zoom),onValueChange:e=>x(Object.assign(Object.assign({},y),{zoom:e/100}))})))}},34591:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564);t.default=({data:e})=>l.default.createElement(i.TableContainer,{tabIndex:0,component:i.Paper,sx:{mb:0,mt:0},className:"metadata"},l.default.createElement(i.Table,{"aria-label":"metadata table"},l.default.createElement(i.TableBody,null,Object.entries(e).map((([e,t],a)=>l.default.createElement(i.TableRow,{key:a,sx:{"&:last-child td, &:last-child th":{border:0}}},l.default.createElement(i.TableCell,{align:"right",component:"th",scope:"row"},l.default.createElement("b",null,e)),l.default.createElement(i.TableCell,null,t)))))))},61609:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=a(5610),s=e=>void 0===e||isNaN(e)?"00:00":`${Math.floor(e/60).toString().padStart(2,"0")}:${Math.round(e%60).toString().padStart(2,"0")}`;t.default=({timestamp:e,secondary:t,duration:a,marks:n,setTimestamp:r,setSecondary:d,secondaryThumbnail:u})=>l.default.createElement(i.Box,{sx:{width:"100%"},className:"playbar"},l.default.createElement(i.Stack,{direction:"row",alignItems:"center",spacing:2},l.default.createElement(i.Typography,{fontSize:"small"},s(e),"/",s(a)),l.default.createElement(i.Box,{style:{width:"100%",display:"inherit",position:"relative"}},void 0!==t&&void 0!==a?l.default.createElement(i.Box,{style:{position:"absolute",maxWidth:100,maxHeight:100,left:o.pct2css(t/a),bottom:"60%"}},u):null,l.default.createElement(i.Slider,{size:"small",min:0,step:.01,classes:{thumb:"slider-thumb"},componentsProps:{markLabel:{onClick:e=>{const t=e.currentTarget.getAttribute("data-index");t&&r(n[parseInt(t)])}}},max:a||10,valueLabelDisplay:"auto",marks:n.map((e=>({value:e,label:e}))),value:[e].concat(void 0!==t?[t]:[]),onChange:(e,t,a)=>{const n=t,l=e.altKey;l&&(1==n.length||n[a]>=n[1-a])?d(n[a]):l||r(n[a])}}))))},22834:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=a(5610);t.default=e=>{var{polygon:t,color:a,candidate:l}=e,s=n(e,["polygon","color","candidate"]);const{points:r,xmin:d,ymin:u,xmax:c,ymax:m}=((e,t)=>{const a=t?e.concat([t]):e,[n,l,i,o]=[Math.min,Math.max].map((e=>["x","y"].map((t=>e.apply(Math,a.map((e=>e[t]))))))).flat();return{points:a,xmin:n,ymin:l,xmax:i,ymax:o}})(t.points,l),f=Math.max(c-d,o.epsilon),g=Math.max(m-u,o.epsilon);return i.default.createElement("svg",Object.assign({className:"region polygon",width:o.pct2css(f),height:o.pct2css(g)},s,{style:Object.assign({position:"absolute",left:o.pct2css(d),top:o.pct2css(u),overflow:"visible"},s.style||{})}),i.default.createElement("text",Object.assign({fill:a},s,{className:"box-text",alignmentBaseline:"hanging",onClick:s.onClick}),o.labels2string(t.labels)),i.default.createElement("svg",Object.assign({},s),Array.from(Array(r.length-1).keys()).map((e=>i.default.createElement("line",{key:e,stroke:a,strokeWidth:"calc(2px / var(--media-viewer-scale, 1))",x1:o.pct2css((r[e].x-d)/f),y1:o.pct2css((r[e].y-u)/g),x2:o.pct2css((r[e+1].x-d)/f),y2:o.pct2css((r[e+1].y-u)/g)})))))}},95599:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=a(78564),i=n(a(56271));t.default=e=>i.default.createElement(l.Box,{sx:{display:"flex",alignItems:"center"}},i.default.createElement(l.Box,{sx:{width:"100%",mr:1}},i.default.createElement(l.LinearProgress,{variant:"determinate",value:e.progress})),i.default.createElement(l.Box,{sx:{minWidth:20,textAlign:"right"}},i.default.createElement(l.Typography,{variant:"body2",color:"text.secondary"},`${Math.round(e.progress)}%`)))},99850:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=a(78564);t.default=e=>{var{name:t,value:a,onValueChange:l,min:s,max:r,width:d,disabled:u}=e,c=n(e,["name","value","onValueChange","min","max","width","disabled"]);return i.default.createElement(o.Stack,{direction:"row",alignItems:"center",spacing:2,style:d?{width:d}:{}},i.default.createElement(o.Typography,{fontSize:"small"},t),i.default.createElement(o.Slider,Object.assign({},c,{size:"small",value:a,style:d?{width:d}:{},min:s,classes:{thumb:"slider-thumb"},max:r,disabled:u,valueLabelDisplay:"on",valueLabelFormat:Math.round,onChange:(e,t)=>l(t)})))}},41825:function(e,t,a){"use strict";var n=this&&this.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var l=0;for(n=Object.getOwnPropertySymbols(e);l<n.length;l++)t.indexOf(n[l])<0&&Object.prototype.propertyIsEnumerable.call(e,n[l])&&(a[n[l]]=e[n[l]])}return a},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=l(a(56271)),o=a(5610);t.default=e=>{var{radius:t,round:a,x:l,y:s,crosshair:r}=e,d=n(e,["radius","round","x","y","crosshair"]);return i.default.createElement("div",Object.assign({},d,{className:"mask-cursor",style:Object.assign(Object.assign({},d.style||{}),{height:2*t+"px",width:2*t+"px",boxSizing:"content-box",borderRadius:a?`${t+2}px`:void 0,transform:`translate(${-t-2}px, ${-t-2}px) scale(calc(1/var(--media-viewer-scale, 1)))`,left:o.pct2css(l),top:o.pct2css(s),position:"absolute",border:"2px solid red",cursor:"none",overflow:"visible",pointerEvents:"none"})}),r?i.default.createElement("svg",{style:{position:"absolute",left:"-10%",top:"-10%",height:"120%",width:"120%",overflow:"visible",pointerEvents:"none"}},i.default.createElement("line",{x1:"50%",x2:"50%",y1:"0%",y2:"100%",stroke:"red",strokeWidth:"2px"}),i.default.createElement("line",{y1:"50%",y2:"50%",x1:"0%",x2:"100%",stroke:"red",strokeWidth:"2px"})):null)}},9035:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=n(a(22834)),s=n(a(10955)),r=n(a(41825)),d=n(a(6150)),u=a(22493),c=i.styled(i.Box)`
  .box-text {
    font-size: calc(10pt / var(--media-viewer-scale, 1));
    font-family: Roboto, Helvetica, Arial, sans-serif;
    transform: translate(
      calc(10px / var(--media-viewer-scale, 1)),
      calc(10px / var(--media-viewer-scale, 1))
    );
  }
`;t.default=({config:e,draft:t,callbacks:a,cursor:n})=>{var i,m;const f=(null==e?void 0:e.regions)&&e.regions.length>0?"none":void 0;return l.default.createElement(c,null,t.labels.masks.map(((e,n)=>{var i;return"masks"!==t.drawing.mode||(null===(i=t.drawing.active)||void 0===i?void 0:i.idx)!==n?l.default.createElement(d.default,Object.assign({color:e.readonly?"yellow":"blue",key:n,bitmap:e.map,style:{cursor:f,pointerEvents:"masks"===t.drawing.mode?void 0:"none"}},a)):null})),t.labels.polygons.map(((e,n)=>{var i;return"polygons"!==t.drawing.mode||(null===(i=t.drawing.active)||void 0===i?void 0:i.idx)!==n?l.default.createElement(o.default,Object.assign({polygon:e,style:{cursor:f,pointerEvents:"polygons"===t.drawing.mode?void 0:"none"},key:n,color:e.readonly?"yellow":"blue"},a,{onClick:t=>a.onClick(t,e,n)})):null})),t.labels.boxes.map(((e,n)=>{var i;return"boxes"!==t.drawing.mode||(null===(i=t.drawing.active)||void 0===i?void 0:i.idx)!==n?l.default.createElement(s.default,Object.assign({color:e.readonly?"yellow":"blue",box:e,key:n,style:{cursor:f,pointerEvents:"boxes"===t.drawing.mode?void 0:"none"}},a,{onClick:t=>a.onClick(t,e,n)})):null})),t.drawing.active?"polygons"===t.drawing.mode?l.default.createElement(o.default,Object.assign({color:"red",polygon:t.drawing.active.region},a,{candidate:t.drawing.active.idx>-1?void 0:n.coords,style:{cursor:f,pointerEvents:"none"}})):"boxes"===t.drawing.mode?l.default.createElement(s.default,Object.assign({color:"red",box:t.drawing.active.region,candidate:t.drawing.active.idx>-1?void 0:n.coords,style:{cursor:f,pointerEvents:"none"}},a)):"masks"===t.drawing.mode?l.default.createElement(d.default,Object.assign({color:"red"},a,{bitmap:t.drawing.active.region.map,style:{cursor:f,pointerEvents:"none"}})):null:null,n.coords&&void 0!==n?l.default.createElement(r.default,Object.assign({},a,{radius:"masks"===t.drawing.mode?n.radius:5,x:n.coords.x,y:n.coords.y,crosshair:"masks"!==t.drawing.mode&&("boxes"===t.drawing.mode||!u.isPolygonClosed(n.coords,null===(m=null===(i=t.drawing.active)||void 0===i?void 0:i.region)||void 0===m?void 0:m.points)),round:"masks"!==t.drawing.mode})):null)}},39922:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(a(56271)),i=a(78564),o=a(48931),s=n(a(20544)),r=i.styled(i.Box)`
  & .recharts-reference-area-rect {
    fill-opacity: 0.25;
  }
  & .recharts-reference-area.active .recharts-reference-area-rect:hover,
  .recharts-reference-area-rect:hover {
    fill: red;
  }
  & .recharts-reference-area.active .recharts-reference-area-rect {
    fill: blue;
  }

  & .recharts-dot {
    fill: white;
    stroke: var(--line-color);
  }

  & .recharts-dot.hoverable:hover,
  .recharts-dot.active {
    fill: var(--line-color);
  }

  & .recharts-dot.active:hover {
    fill: red;
    stroke: red;
  }

  & .recharts-text.recharts-label {
    text-anchor: middle;
  }
`;t.default=({target:e,toggle:t,labels:a})=>{const{setFocus:n}=l.default.useContext(s.default),i=l.default.useMemo((()=>e.plots.map((e=>e.x.values.map(((t,a)=>Object.assign(Object.assign({},Object.fromEntries(e.y.lines.map((e=>[e.name,e.values[a]])))),{[e.x.name]:t})))))),[e]);return l.default.createElement(r,{onClick:n},e.plots.map(((e,s)=>{var r,d,u,c,m,f,g,p,v,b,h,y;return l.default.createElement(o.LineChart,{key:s,width:(null===(r=e.size)||void 0===r?void 0:r.width)||512,height:(null===(d=e.size)||void 0===d?void 0:d.height)||256,data:i[s]},l.default.createElement(o.XAxis,{height:e.x.height||60,dataKey:e.x.name,type:e.x.type||"number",tickCount:e.x.tickCount,label:e.x.name}),l.default.createElement(o.YAxis,{type:(null===(u=e.y.types)||void 0===u?void 0:u.left)||"number",domain:null===(c=e.y.limits)||void 0===c?void 0:c.left,allowDataOverflow:!0,label:(null===(m=e.y.labels)||void 0===m?void 0:m.left)?{value:null===(f=e.y.labels)||void 0===f?void 0:f.left,angle:-90,position:"insideLeft"}:void 0,width:(null===(g=e.y.widths)||void 0===g?void 0:g.left)||60,yAxisId:"left",orientation:"left"}),l.default.createElement(o.YAxis,{type:(null===(p=e.y.types)||void 0===p?void 0:p.right)||"number",allowDataOverflow:!0,domain:null===(v=e.y.limits)||void 0===v?void 0:v.right,label:(null===(b=e.y.labels)||void 0===b?void 0:b.right)?{value:null===(h=e.y.labels)||void 0===h?void 0:h.right,angle:-90,position:"insideRight"}:void 0,width:(null===(y=e.y.widths)||void 0===y?void 0:y.right)||60,yAxisId:"right",orientation:"right"}),l.default.createElement(o.Legend,null),l.default.createElement(o.CartesianGrid,null),(e.areas||[]).map(((e,i)=>l.default.createElement(o.ReferenceArea,{yAxisId:"left",label:e.label,key:i,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,className:(a.image&&a.image[e.labelKey]?a.image[e.labelKey]:[]).indexOf(e.labelVal)>-1?"active":void 0,onClick:()=>{t&&t(e.labelKey,e.labelVal),n()}}))),e.y.lines.map(((n,i)=>l.default.createElement(o.Line,{key:i,animationDuration:e.y.animation||1500,yAxisId:n.axis||"left",type:n.type||"monotone",dataKey:n.name,stroke:n.color,dot:!!n.dot&&(i=>{var s,r;const d=i.payload[e.x.name],u=a.image&&!!(null===(s=n.dot)||void 0===s?void 0:s.labelKey),c=!(!u||!a.image[n.dot.labelKey])&&(a.image[n.dot.labelKey]||[]).indexOf(d.toString())>-1,m={key:i.key,r:i.r,cx:i.cx,cy:i.cy,strokeWidth:i.strokeWidth,style:{"--line-color":i.stroke},className:c?"active":u?"hoverable":void 0,onClick:(null===(r=n.dot)||void 0===r?void 0:r.labelKey)&&t?()=>t(n.dot.labelKey,d.toString()):void 0};return l.default.createElement(o.Dot,Object.assign({},m))})}))))})))}},109:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.unfill=t.fillHsv=t.img2hsv=t.findMaskByPoint=t.values2counts=t.counts2values=t.findLastIndex=void 0;const a=255,n=[{dx:0,dy:-1},{dx:-1,dy:0},{dx:0,dy:1},{dx:1,dy:0}];function l(e,t){let a=e.length;for(;a--;)if(t(e[a],a,e))return a;return-1}t.findLastIndex=l;const i=(e,t)=>Object.assign(Object.assign({},e),{x:e.x+t.dx,y:e.y+t.dy});t.img2hsv=(e,t,a)=>{const n=t.getContext("2d"),l={width:"VIDEO"===(i=e).nodeName?i.videoWidth:i.naturalWidth,height:"VIDEO"===i.nodeName?i.videoHeight:i.naturalHeight};var i;if(!n)throw Error("Failed to get a drawing context.");const o=a/Math.max(l.width,l.height);t.width=Math.round(o*l.width),t.height=Math.round(o*l.height),n.drawImage(e,0,0,l.width,l.height,0,0,t.width,t.height);try{const e=Array.from(n.getImageData(0,0,t.width,t.height).data);return{hsv:new Uint8ClampedArray(Array.from(Array(t.width*t.height).keys()).map((t=>((...e)=>{const[t,a,n]=e,l=Math.max(t,a,n),i=Math.min(t,a,n),o=l-i,s=0===l?0:o/l,r=l/255,d=6*o;let u;switch(l){case i:u=0;break;case t:u=(a-n+o*(a<n?6:0))/d;break;case a:u=(n-t+2*o)/d;break;case n:u=(t-a+4*o)/d;break;default:throw"Failed to select appropriate value for h."}return[u,s,r].map((e=>Math.min(Math.round(255*e),255)))})(...e.slice(4*t,4*t+3)))).flat()),width:t.width,height:t.height}}catch(e){return console.error(`Failed to load image, likely due to CORS issues: ${e}.`),{width:t.width,height:t.height}}};const o=(e,t)=>e.y*t+e.x,s=(e,t)=>({x:Math.round(e.x*t.sx),y:Math.round(e.y*t.sy)}),r=(e,t,a)=>{const n={x:Math.max(0,Math.round((e.x-t.dx)*a.width)),y:Math.max(0,Math.round((e.y-t.dy)*a.height))};return{point:n,kernel:{dx:Math.min(Math.round((2*t.dx+Math.min(0,e.x-t.dx))*a.width),a.width-n.x),dy:Math.min(Math.round((2*t.dy+Math.min(0,e.y-t.dy))*a.height),a.height-n.y)}}},d=(e,t,a,n)=>{if(t.x<0||t.y<0||t.x+a.dx>e.dimensions.width||t.y+a.dy>e.dimensions.height)throw`Detected invalid block fill point/parameters. kernel: (${a.dx}, ${a.dy}), point: (${t.x}, ${t.y}), dimensions: (${e.dimensions.width}, ${e.dimensions.height})`;const l=Array(a.dx).fill(n);Array.from(Array(a.dy).keys()).forEach((a=>{e.values.set(l,(t.y+a)*e.dimensions.width+t.x)}))};t.unfill=(e,t,a)=>{const n=r(e,a,t.dimensions);return d(t,n.point,n.kernel,0),t.values},t.fillHsv=(e,t,l)=>{const u=Math.pow(l.threshold,2);if(l.previous&&t.width*t.height!==l.previous.values.length)throw`Incompatible dimensions for mask (${l.previous.values.length}) and canvas (${t.width}x${t.height}).`;const c={values:new Uint8ClampedArray(l.previous?l.previous.dimensions.width*l.previous.dimensions.height:t.width*t.height),dimensions:l.previous?l.previous.dimensions:{height:t.height,width:t.width}},m={sx:c.dimensions.width/t.width,sy:c.dimensions.height/t.height},f={equals:(e,t)=>((e,t,a)=>{if(3!==e.length||3!==t.length)throw"These points do not have the same number of color values.";const[n,l,i]=e,[o,s,r]=t,d=2*Math.min(Math.abs(o-n),255-Math.abs(o-n)),u=Math.abs(s-l),c=Math.abs(r-i);return d*d+u*u+c*c<=a})(Array.from(e),Array.from(t),u),isInBounds:e=>e.x<t.width&&e.y<t.height&&e.x>=0&&e.y>=0,getImageValue:e=>{var a;const n=3*o(e,t.width);return null===(a=t.hsv)||void 0===a?void 0:a.slice(n,n+3)},getMatchValue:e=>{const t=o(s(e,m),c.dimensions.width),l=c.values[t];switch(l){case 0:return"unknown";case a:return"matched";default:return e.direction<0||"0"===l.toString(2).padStart(n.length,"0")[e.direction]?"unknown":"visited"}},setMatchValue:(e,t)=>{const l=o(s(e,m),c.dimensions.width);switch(t){case"matched":c.values[l]=a;break;case"visited":const i=c.values[l].toString(2).padStart(n.length,"0"),o=parseInt(i.substring(0,e.direction)+1+i.substring(e.direction+1),2);c.values[l]=o;break;default:throw`Unsupported flood map setting passed: ${t}`}}},g=r(e,l.radius,c.dimensions),p=r(e,l.radius,t);return d(c,g.point,g.kernel,a),((e,t,a)=>{const l=e.filter((e=>t.isInBounds(e)));let o=0;if(a)for(;l.length>0&&o<a;){const e=l.shift(),a=n.map(((t,a)=>Object.assign(Object.assign({},i(e,t)),{origin:e,direction:a}))).filter(t.isInBounds).filter((e=>"unknown"==t.getMatchValue(e))),s=a.filter((e=>{const a=t.getImageValue(e),n=t.getImageValue(e.origin);return void 0!==n&&void 0!==a&&t.equals(n,a)}));a.forEach((e=>t.setMatchValue(e,"visited"))),s.forEach((e=>t.setMatchValue(e,"matched"))),l.push(...s),o+=1}})(((e,t)=>[Array.from(Array(t.dx).keys()).map((a=>[{x:a+e.x,y:e.y},{x:a+e.x,y:e.y+t.dy}])),Array.from(Array(t.dy).keys()).map((a=>[{y:a+e.y,x:e.x},{y:a+e.y,x:e.x+t.dx}]))].flat(2).map((t=>Object.assign(Object.assign({},t),{origin:e,direction:-1}))))(p.point,p.kernel),f,t.hsv?1e6:0),l.previous&&l.previous.values.forEach(((e,t)=>{e===a&&(c.values[t]=e)})),l.radius&&t.hsv&&((e,t)=>{for(let n=0;n<=e.dimensions.height-t.dy;n++){let l=0;for(;l<=e.dimensions.width-t.dx;)[{dx:0,dy:0},{dx:t.dx,dy:0},t,{dx:0,dy:t.dy}].map((t=>(n+t.dy)*e.dimensions.width+l+t.dx)).every((t=>e.values[t]===a))?(d(e,{x:l,y:n},t,a),l+=t.dx):l+=1}})(c,{dx:Math.round(l.radius.dx*c.dimensions.width),dy:Math.round(l.radius.dy*c.dimensions.height)}),c.values},t.counts2values=e=>new Uint8ClampedArray(e.map(((e,t)=>Array.from(Array(e).keys()).map((()=>t%2==0?a:0)))).flat()),t.values2counts=e=>e.reduce(((e,t)=>((e.length-1)%2==0==(t==a)?e[e.length-1]+=1:e.push(1),e)),[0]),t.findMaskByPoint=(e,t)=>l(t,(t=>t.map.values[Math.round(e.y*t.map.dimensions.height)*t.map.dimensions.width+Math.round(e.x*t.map.dimensions.width)]===a))},22493:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.snapPolygonCoords=t.isPolygonClosed=t.computeDistance=void 0,t.computeDistance=(e,t,a)=>Math.pow((e.x-t.x)*(a?a.width:1),2)+Math.pow((e.y-t.y)*(a?a.height:1),2),t.isPolygonClosed=(e,t)=>{if(!t||0===t.length)return!1;const a=t[0];return e.x===a.x&&e.y===a.y},t.snapPolygonCoords=(e,a,n)=>{if(!a.active||"polygons"!==a.mode||0==a.active.region.points.length)return e;const l=a.active.region.points[0];return Math.sqrt(t.computeDistance(l,e.coords,n))>10?e:Object.assign(Object.assign({},e),{coords:l})}},11599:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processSelectionChange=t.handleMediaClick=void 0;const n=a(109),l=a(22493),i=a(5610);t.handleMediaClick=(e,t,a,o,s,r,d,u)=>{let c=e.drawing;if(!o.source.current)throw"Did not find relevant media elements.";const m=parseFloat(getComputedStyle(o.source.current).getPropertyValue("--media-viewer-scale")||"1");if(1==parseFloat(getComputedStyle(o.source.current).getPropertyValue("--media-viewer-dragging")||"0"))return e;if(c.active&&c.active.idx>-1)return Object.assign(Object.assign({},e),{drawing:Object.assign(Object.assign({},c),{active:void 0}),labels:Object.assign(Object.assign({},e.labels),{[c.mode]:c.active?i.insertOrAppend(e.labels[c.mode],e.drawing.active.region,e.drawing.active.idx,!0):e.labels[c.mode]})});if("masks"==c.mode){if(!o.canvas.current)throw"Did not find necessary canvas element.";const l=e.canvas||n.img2hsv(o.source.current,o.canvas.current,d||512),i=Object.assign(Object.assign({},l),{hsv:c.flood?l.hsv:void 0});if("masks"===c.mode&&c.flood&&!i.hsv)throw"Flood fill failed due to cross-origin media. Please disable flood fill.";const r={previous:c.active?c.active.region.map:void 0,radius:{dx:t.radius/o.source.current.clientWidth/m,dy:t.radius/o.source.current.clientHeight/m},threshold:t.threshold};if(c.active)c.active=Object.assign(Object.assign({},c.active),{region:Object.assign(Object.assign({},c.active.region),{map:Object.assign(Object.assign({},c.active.region.map),{values:s&&r.previous?n.unfill(a,r.previous,r.radius):n.fillHsv(a,i,r)})})});else{const t=n.findMaskByPoint(a,e.labels.masks);c.active=-1===t||s?{idx:-1,region:{map:{dimensions:{width:l.width,height:l.height},values:n.fillHsv(a,i,r)},labels:{}}}:{idx:t,region:e.labels.masks[t]}}return Object.assign(Object.assign({},e),{canvas:l,drawing:c})}if("polygons"===c.mode)return c.active?c.active=Object.assign(Object.assign({},c.active),{region:Object.assign(Object.assign({},c.active.region),{points:c.active.region.points.concat([l.snapPolygonCoords(Object.assign(Object.assign({},t),{coords:a}),c,{width:o.source.current.clientWidth*m,height:o.source.current.clientHeight*m}).coords])})}):c.active=r&&!s&&void 0!==u?{region:r,idx:u}:{region:{points:[a],labels:{}},idx:-1},Object.assign(Object.assign({},e),{drawing:c});if("boxes"===c.mode){if(c.active){let e,t;c.active.region.pt2&&l.computeDistance(a,c.active.region.pt1)<l.computeDistance(a,c.active.region.pt2)?(e=a,t=c.active.region.pt2):(e=c.active.region.pt1,t=a),c.active=Object.assign(Object.assign({},c.active),{region:Object.assign(Object.assign({},c.active.region),{pt1:e,pt2:t})})}else c.active=r&&!s&&void 0!==u?{region:r,idx:u}:{region:{pt1:a,labels:{}},idx:-1};return Object.assign(Object.assign({},e),{drawing:c})}throw"Failed to handle media click operation."},t.processSelectionChange=(e,t,a)=>t&&t.indexOf(e)>-1?a?t.filter((t=>t!=e)):[]:a?(t||[]).concat([e]):[e]},30969:function(e,t,a){"use strict";var n=this&&this.__awaiter||function(e,t,a,n){return new(a||(a=Promise))((function(l,i){function o(e){try{r(n.next(e))}catch(e){i(e)}}function s(e){try{r(n.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(o,s)}r((n=n.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.usePlaybackState=t.useMediaMouseCallbacks=t.useDraftLabelState=t.useLoader=t.useInterval=t.simulateHover=t.simulateScroll=t.simulateClick=t.delay=t.useKeyboardEvent=t.useMediaEvent=t.useMediaLarge=t.convertCoordinates=void 0;const i=l(a(56271)),o=l(a(90328)),s=a(78564),r=a(5610),d=a(11599),u=a(22493),c=l(a(20544));t.convertCoordinates=(e,t)=>{if(!t)throw Error("Requested mouse position without a ref.");const{x:a,y:n,width:l,height:i}=t.getBoundingClientRect();return{x:(e.x-window.scrollX-a)/l,y:(e.y-window.scrollY-n)/i}},t.useMediaLarge=()=>s.useMediaQuery(s.useTheme().breakpoints.up("sm")),t.useMediaEvent=(e,a,n,l)=>i.default.useMemo((()=>{const n=l&&0!==l?o.default(e,l):e;return(e,...l)=>n(t.convertCoordinates({x:e.nativeEvent.pageX,y:e.nativeEvent.pageY},a.current),e,...l)}),[...n||[],a]),t.useKeyboardEvent=(e,t)=>{const{hasFocus:a}=i.default.useContext(c.default),n=i.default.useCallback((t=>{var n,l;const i=!(!t.target||!t.target.closest(".react-image-labeler-input-target")),o=null===(n=t.target)||void 0===n?void 0:n.nodeName,s="true"===(null===(l=t.target)||void 0===l?void 0:l.contentEditable);a&&"TEXTAREA"!==o&&("INPUT"!==o||i&&a)&&!s&&e(t)}),(t||[]).concat([e,a]));i.default.useEffect((()=>(document.addEventListener("keydown",n,!1),()=>{document.removeEventListener("keydown",n,!1)})),[n])},t.delay=e=>new Promise((t=>setTimeout(t,e))),t.simulateClick=(e,a)=>new Promise((n=>{if(!e)return;e.focus({preventScroll:!0}),e.classList.add("active");const{x:l,y:i}=e.getBoundingClientRect(),o=Object.assign({bubbles:!0,cancelable:!0},a?{clientX:l+a.x,clientY:i+a.y}:{});e.dispatchEvent(new MouseEvent("mousedown",o)),e.dispatchEvent(new MouseEvent("mouseup",o)),t.delay(100).then((()=>{e.dispatchEvent(new MouseEvent("click",o)),e.classList.remove("active"),e.blur(),n()}))})),t.simulateScroll=(e,t,a)=>n(void 0,void 0,void 0,(function*(){e&&e.dispatchEvent(new WheelEvent("wheel",{deltaX:t.x,deltaY:t.y,ctrlKey:a}))})),t.simulateHover=(e,t)=>{if(!e)return;const{x:a,y:n}=e.getBoundingClientRect();null==e||e.dispatchEvent(new MouseEvent("mousemove",Object.assign({bubbles:!0,cancelable:!0},t?{clientX:a+t.x,clientY:n+t.y}:{})))};const m=()=>{};t.useInterval=(e,t,a,n)=>{const l=i.default.useRef(m);i.default.useEffect((()=>{l.current=e})),i.default.useEffect((()=>{a&&null!==t&&!1!==t&&l.current()}),[a]),i.default.useEffect((()=>{if(null===t||!1===t)return;const e=setInterval((()=>l.current()),t);return()=>clearInterval(e)}),[t].concat(n||[]))},t.useLoader=(e,t)=>{const{setToast:a}=i.default.useContext(c.default),[n,l]=i.default.useState({src:t,loadState:"loading",mediaState:void 0});return i.default.useEffect((()=>{t!==n.src&&l({src:t,loadState:t?"loading":"loaded",mediaState:n.mediaState})}),[t]),Object.assign(Object.assign({},n),{callbacks:{onError:i.default.useCallback((()=>{l(Object.assign(Object.assign({},n),{loadState:"error"})),a(`An error occurred loading ${n.src}.`)}),[n]),onLoad:i.default.useCallback((t=>{e(t).then((e=>l({mediaState:e,loadState:"loaded",src:n.src})),(e=>a(`An error occurred loading ${n.src}.`)))}),[e,n])}})},t.useDraftLabelState=(e,t)=>{const[a,n]=i.default.useState({labels:r.labels2draft(e||{}),dirty:!1,canvas:null,drawing:{mode:"boxes"}}),[l,o]=i.default.useState({radius:5,threshold:1,coords:void 0}),s=i.default.useCallback((()=>n(Object.assign(Object.assign({},a),{labels:r.labels2draft(e||{}),dirty:!1,canvas:null,drawing:"masks"===a.drawing.mode?{mode:"masks",flood:a.drawing.flood}:{mode:a.drawing.mode}}))),[e,a]);return i.default.useEffect((()=>{s()}),[e].concat(t||[])),{cursor:l,setCursor:o,draft:a,setDraft:n,resetDraft:s}},t.useMediaMouseCallbacks=(e,a,n,l,o,s,r)=>{const{setFocus:m,setToast:f}=i.default.useContext(c.default);return{onClick:t.useMediaEvent(((t,l,i,u)=>{if(m(),s&&o.source.current&&o.canvas.current)try{a(d.handleMediaClick(e,n,t,o,l.altKey,i,r,u))}catch(e){f(e)}}),o.source,[e,n]),onMouseMove:t.useMediaEvent((t=>{if(!s||!o.source.current)return;const a=parseFloat(getComputedStyle(o.source.current).getPropertyValue("--media-viewer-scale")||"1");l(u.snapPolygonCoords(Object.assign(Object.assign({},n),{coords:t}),e.drawing,{width:o.source.current.clientWidth*a,height:o.source.current.clientHeight*a}))}),o.source,[e,n],0)}};const f=(e,t)=>e&&e.filter((e=>e.timestamp===t))[0]||{timestamp:t,end:void 0,labels:{image:{}}};t.usePlaybackState=(e,a)=>{const{setFocus:n}=i.default.useContext(c.default),[l,o]=i.default.useState({paused:!0,playbackRate:0,muted:!1,timestamp:0,labels:{image:{}},end:void 0});i.default.useEffect((()=>{e.main.current&&o(Object.assign(Object.assign({},l),f(a,e.main.current.currentTime)))}),[a,e.main]),t.useInterval((()=>{!e.main.current||e.main.current.paused===l.paused&&e.main.current.currentTime===l.timestamp&&e.main.current.playbackRate===l.playbackRate||o(Object.assign(Object.assign(Object.assign(Object.assign({},l),{paused:e.main.current.paused,playbackRate:e.main.current.playbackRate}),e.main.current.paused?f(a,e.main.current.currentTime):{end:void 0,labels:{}}),{timestamp:e.main.current.currentTime})),e.secondaryThumbnail.current&&l.end&&e.secondaryThumbnail.current.currentTime!==l.end&&(e.secondaryThumbnail.current.currentTime=l.end),["main","mini"].map((t=>{const a=e[t].current;a&&a&&a.muted!==l.muted&&(a.muted=l.muted)}))}),10,!0);const s=i.default.useCallback((()=>o(Object.assign(Object.assign({},l),{muted:!l.muted}))),[l]),r=i.default.useCallback(((t,a,i)=>{if(e.main.current&&e.mini.current){if(0==t)e.main.current.pause(),e.mini.current.pause();else if(t>0)e.main.current.playbackRate=t,e.mini.current.playbackRate=t,e.main.current.paused&&(e.main.current.play(),e.mini.current.play());else if(t<0)throw"Rewinding is not supported.";void 0!==a&&(e.main.current.currentTime=a,e.mini.current.currentTime=a),void 0!==i&&o(Object.assign(Object.assign({},l),{end:i})),n()}}),[e,l,n]);return{playbackState:l,setPlaybackState:r,toggleMute:s}}},5610:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.shortcutify=t.insertOrAppendByTimestamp=t.draft2labels=t.fixBox=t.labels2draft=t.epsilon=t.labels2string=t.copy=t.insertOrAppend=t.pct2css=void 0;const n=a(109);t.pct2css=e=>100*e+"%",t.insertOrAppend=(e,t,a,n)=>(n?[t]:[]).concat(e.slice(0,a>-1?a:void 0).concat(a>-1?e.slice(a+1):[])),t.copy=e=>{try{return JSON.parse(JSON.stringify(e))}catch(t){throw`Failed to copy object: ${e}`}},t.labels2string=e=>Object.keys(e).filter((t=>1==e[t].length)).map((t=>`${t}: ${e[t][0]}`)).join(", "),t.epsilon=1e-4,t.labels2draft=e=>({image:t.copy((null==e?void 0:e.image)||{}),polygons:t.copy((null==e?void 0:e.polygons)||[]),masks:((null==e?void 0:e.masks)||[]).map((e=>Object.assign(Object.assign({},e),{map:{dimensions:e.map.dimensions,values:n.counts2values(e.map.counts)}}))),dimensions:(null==e?void 0:e.dimensions)?t.copy(e.dimensions):void 0,boxes:t.copy((null==e?void 0:e.boxes)||[])}),t.fixBox=e=>{const t=e.pt1,a=e.pt2||e.pt1;return Object.assign(Object.assign({},e),{pt1:{x:Math.min(t.x,a.x),y:Math.min(t.y,a.y)},pt2:{x:Math.max(t.x,a.x),y:Math.max(t.y,a.y)}})},t.draft2labels=e=>Object.assign(Object.assign({},e),{boxes:e.boxes.map(t.fixBox),masks:e.masks.map((e=>Object.assign(Object.assign({},e),{map:{dimensions:e.map.dimensions,counts:n.values2counts(e.map.values)}})))}),t.insertOrAppendByTimestamp=(e,a)=>t.insertOrAppend(a,e,a.findIndex((t=>t.timestamp===e.timestamp)),!0).sort(((e,t)=>e.timestamp>t.timestamp?1:-1)),t.shortcutify=e=>{let t=e.reduce(((e,t)=>t.options?e.concat(t.options.filter((e=>e.shortcut)).map((e=>e.shortcut))):e),[]);return e.map((e=>Object.assign(Object.assign({},e),{options:e.options?e.options.map((e=>{let a=e.shortcut;return a||(a=[...e.name.toLowerCase()].find((e=>-1==t.indexOf(e))),a&&t.push(a)),Object.assign(Object.assign({},e),{shortcut:a})})):void 0})))}},4741:function(e,t,a){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Demonstrator=t.Labeler=t.TimeSeriesLabeler=t.BatchImageLabeler=t.VideoLabeler=t.ImageLabeler=t.MediaIndex=void 0;const l=n(a(30284));t.ImageLabeler=l.default;const i=n(a(13673));t.VideoLabeler=i.default;const o=n(a(72428));t.BatchImageLabeler=o.default;const s=n(a(8800));t.Labeler=s.default;const r=n(a(46951));t.Demonstrator=r.default;const d=n(a(48847));t.MediaIndex=d.default;const u=n(a(28831));t.TimeSeriesLabeler=u.default},18657:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MODULE_NAME=t.MODULE_VERSION=void 0;const n=a(4147);t.MODULE_VERSION=n.version,t.MODULE_NAME=n.name},95318:e=>{e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},50594:(e,t,a)=>{"use strict";var n=a(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(64938)),i=a(85893),o=(0,l.default)((0,i.jsx)("path",{d:"M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close");t.default=o},64938:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=a(54040)},35893:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(49064).Z},57144:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(87596).Z},54040:(e,t,a)=>{"use strict";a.r(t),a.d(t,{capitalize:()=>l.Z,createChainedFunction:()=>i.Z,createSvgIcon:()=>o.Z,debounce:()=>s.Z,deprecatedPropType:()=>r,isMuiElement:()=>d.Z,ownerDocument:()=>u.Z,ownerWindow:()=>c.Z,requirePropFactory:()=>m,setRef:()=>f,unstable_ClassNameGenerator:()=>w,unstable_useEnhancedEffect:()=>g.Z,unstable_useId:()=>p.Z,unsupportedProp:()=>v,useControlled:()=>b.Z,useEventCallback:()=>h.Z,useForkRef:()=>y.Z,useIsFocusVisible:()=>x.Z});var n=a(88076),l=a(98216),i=a(35893),o=a(82066),s=a(57144);const r=function(e,t){return()=>null};var d=a(77795),u=a(8038),c=a(5340);a(22122);const m=function(e,t){return()=>null},f=a(7960).Z;var g=a(58974),p=a(27909);const v=function(e,t,a,n,l){return null};var b=a(49299),h=a(2068),y=a(51705),x=a(79674);const w={configure:e=>{console.warn(["MUI: `ClassNameGenerator` import from `@mui/material/utils` is outdated and might cause unexpected issues.","","You should use `import { unstable_ClassNameGenerator } from '@mui/material/className'` instead","","The detail of the issue: https://github.com/mui/material-ui/issues/30011#issuecomment-1024993401","","The updated documentation: https://mui.com/guides/classname-generator/"].join("\n")),n.Z.configure(e)}}},77795:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(56271);const l=function(e,t){return n.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}},8038:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(57094).Z},5340:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(58290).Z},49299:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(8925).Z},58974:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(16600).Z},2068:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(73633).Z},51705:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(30067).Z},27909:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(57579).Z},79674:(e,t,a)=>{"use strict";a.d(t,{Z:()=>n});const n=a(99962).Z},49064:(e,t,a)=>{"use strict";function n(...e){return e.reduce(((e,t)=>null==t?e:function(...a){e.apply(this,a),t.apply(this,a)}),(()=>{}))}a.d(t,{Z:()=>n})},87596:(e,t,a)=>{"use strict";function n(e,t=166){let a;function n(...n){clearTimeout(a),a=setTimeout((()=>{e.apply(this,n)}),t)}return n.clear=()=>{clearTimeout(a)},n}a.d(t,{Z:()=>n})},57094:(e,t,a)=>{"use strict";function n(e){return e&&e.ownerDocument||document}a.d(t,{Z:()=>n})},58290:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(57094);function l(e){return(0,n.Z)(e).defaultView||window}},7960:(e,t,a)=>{"use strict";function n(e,t){"function"==typeof e?e(t):e&&(e.current=t)}a.d(t,{Z:()=>n})},8925:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(56271);function l({controlled:e,default:t,name:a,state:l="value"}){const{current:i}=n.useRef(void 0!==e),[o,s]=n.useState(t);return[i?e:o,n.useCallback((e=>{i||s(e)}),[])]}},16600:(e,t,a)=>{"use strict";a.d(t,{Z:()=>l});var n=a(56271);const l="undefined"!=typeof window?n.useLayoutEffect:n.useEffect},73633:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(56271),l=a(16600);function i(e){const t=n.useRef(e);return(0,l.Z)((()=>{t.current=e})),n.useCallback(((...e)=>(0,t.current)(...e)),[])}},30067:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var n=a(56271),l=a(7960);function i(e,t){return n.useMemo((()=>null==e&&null==t?null:a=>{(0,l.Z)(e,a),(0,l.Z)(t,a)}),[e,t])}},57579:(e,t,a)=>{"use strict";a.d(t,{Z:()=>o});var n=a(56271);let l=0;const i=n.useId;function o(e){if(void 0!==i){const t=i();return null!=e?e:t}return function(e){const[t,a]=n.useState(e),i=e||t;return n.useEffect((()=>{null==t&&(l+=1,a(`mui-${l}`))}),[t]),i}(e)}},99962:(e,t,a)=>{"use strict";a.d(t,{Z:()=>c});var n=a(56271);let l,i=!0,o=!1;const s={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function r(e){e.metaKey||e.altKey||e.ctrlKey||(i=!0)}function d(){i=!1}function u(){"hidden"===this.visibilityState&&o&&(i=!0)}function c(){const e=n.useCallback((e=>{var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",r,!0),t.addEventListener("mousedown",d,!0),t.addEventListener("pointerdown",d,!0),t.addEventListener("touchstart",d,!0),t.addEventListener("visibilitychange",u,!0))}),[]),t=n.useRef(!1);return{isFocusVisibleRef:t,onFocus:function(e){return!!function(e){const{target:t}=e;try{return t.matches(":focus-visible")}catch(e){}return i||function(e){const{type:t,tagName:a}=e;return!("INPUT"!==a||!s[t]||e.readOnly)||"TEXTAREA"===a&&!e.readOnly||!!e.isContentEditable}(t)}(e)&&(t.current=!0,!0)},onBlur:function(){return!!t.current&&(o=!0,window.clearTimeout(l),l=window.setTimeout((()=>{o=!1}),100),t.current=!1,!0)},ref:e}}},4147:e=>{"use strict";e.exports=JSON.parse('{"name":"qslwidgets","version":"0.0.35","description":"Widgets for the QSL image labeling package.","keywords":["jupyter","jupyterlab","jupyterlab-extension","widgets"],"files":["lib/**/*.js","dist/*.js","css/*.css"],"homepage":"https://github.com/faustomorales/qsl","bugs":{"url":"https://github.com/faustomorales/qsl/issues"},"license":"MIT","author":{"name":"Fausto Morales","email":"fausto@robinbay.com"},"main":"lib/index.js","types":"./lib/index.d.ts","repository":{"type":"git","url":"https://github.com/faustomorales/qsl"},"scripts":{"build":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension:dev","build:prod":"yarn run build:lib && yarn run build:nbextension && yarn run build:labextension","build:labextension":"jupyter labextension build .","build:labextension:dev":"jupyter labextension build --development True .","build:lib":"tsc","build:nbextension":"webpack","clean":"yarn run clean:lib && yarn run clean:nbextension && yarn run clean:labextension","clean:lib":"rimraf lib","clean:labextension":"rimraf qsl/labextension","clean:nbextension":"rimraf qsl/nbextension/static/index.js","lint":"eslint . --ext .ts,.tsx --fix","lint:check":"eslint . --ext .ts,.tsx","format":"prettier --write src","prepack":"yarn run build:lib","test":"jest","watch":"npm-run-all -p watch:*","watch:lib":"tsc -w","watch:nbextension":"webpack --watch --mode=development","watch:labextension":"jupyter labextension watch .","storybook":"start-storybook -p 6006","build-storybook":"build-storybook"},"dependencies":{"@emotion/react":"^11.8.1","@emotion/styled":"^11.8.1","@jupyter-widgets/base":"^1.1.10 || ^2.0.0 || ^3.0.0 || ^4.0.0","@mui/icons-material":"^5.6.1","@mui/material":"^5.6.1","@mui/x-data-grid":"^5.11.0","@use-gesture/react":"^10.2.15","file-saver":"^2.0.5","html2canvas":"^1.4.1","lodash.debounce":"^4.0.8","react":"^17.0.2","react-dom":"^17.0.2","react-highlight":"^0.14.0","recharts":"^2.1.10"},"devDependencies":{"@babel/core":"^7.14.5","@babel/preset-env":"^7.14.5","@babel/preset-react":"^7.14.5","@babel/preset-typescript":"^7.14.5","@jupyterlab/builder":"^3.0.0","@phosphor/application":"^1.6.0","@phosphor/widgets":"^1.6.0","@storybook/addon-actions":"^6.4.22","@storybook/addon-essentials":"^6.4.22","@storybook/addon-interactions":"^6.4.22","@storybook/addon-links":"^6.4.22","@storybook/react":"^6.4.22","@storybook/testing-library":"^0.0.11","@types/file-saver":"^2.0.5","@types/jest":"^26.0.0","@types/lodash.debounce":"^4.0.7","@types/react":"^17.0.11","@types/react-dom":"^17.0.8","@types/react-highlight":"^0.12.5","@types/webpack-env":"^1.13.6","@typescript-eslint/eslint-plugin":"^3.6.0","@typescript-eslint/parser":"^3.6.0","acorn":"^7.2.0","babel-loader":"^8.2.2","css-loader":"^6.7.1","eslint":"^7.4.0","eslint-config-prettier":"^6.11.0","eslint-plugin-prettier":"^3.1.4","fs-extra":"^7.0.0","html-webpack-plugin":"^5.5.0","identity-obj-proxy":"^3.0.0","jest":"^26.0.0","mkdirp":"^0.5.1","npm-run-all":"^4.1.3","prettier":"^2.0.5","rimraf":"^2.6.2","source-map-loader":"^1.1.3","ts-jest":"^26.0.0","ts-loader":"^8.0.0","typescript":"~4.1.3","webpack":"^5.0.0","webpack-cli":"^4.0.0"},"babel":{"presets":["@babel/preset-env","@babel/preset-react","@babel/preset-typescript"]},"jupyterlab":{"extension":"lib/plugin","outputDir":"../qsl/ui/labextension/","sharedPackages":{"@jupyter-widgets/base":{"bundled":false,"singleton":true}}}}')}}]);